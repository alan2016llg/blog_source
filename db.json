{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[],"Cache":[{"_id":"source/_posts/JSP转HTML中EL表达式替换方式.md","hash":"301d5927c6e58abac4f12d49f9028112829becbd","modified":1578577772054},{"_id":"source/_posts/Mysql常用配置.md","hash":"497646d04fd958ea77b5788ec8c673b049f8fdd1","modified":1578577772057},{"_id":"source/_posts/Spring-Cloud基础微服务搭建-springboot2.md","hash":"557ec015fa98638ad45c709514452e4def8514ac","modified":1578577772074},{"_id":"source/_posts/Spring-Cloud基础微服务搭建.md","hash":"ecb99bc4aca1b95ffdead62f5eeb130a0f6c2fe2","modified":1578577772077},{"_id":"source/_posts/jdk8并发编程神器CompletableFuture初探.md","hash":"fdb8e11e0f7d38b4957287125cc042a7f7f6ae57","modified":1578577772081},{"_id":"source/_posts/一次mysql死锁记录.md","hash":"8d82f47e8c34429e25bf38b8758c183835661d41","modified":1578577772105},{"_id":"source/_posts/大文本文件处理-Tar命令压缩-解压缩.md","hash":"5fcb149330c813e0f53bf15aeec1ae5f07bc59bb","modified":1578577772123},{"_id":"source/_posts/小组分享记录.md","hash":"3b319f171d12d25ca3c629ac872433423add0fd4","modified":1578577772128},{"_id":"source/_posts/搭建自己的linux工作环境.md","hash":"ea1278d610716dc2adaaf4b7f04870e31171f202","modified":1578577772131},{"_id":"source/about/index.md","hash":"d4f07f7b2a462d44a006ebc64e14f2e260f9ddaa","modified":1578577772171},{"_id":"public/about/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006174},{"_id":"public/2019/11/24/一次mysql死锁记录/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006175},{"_id":"public/2019/11/18/Mysql常用配置/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006175},{"_id":"public/2019/11/06/JSP转HTML中EL表达式替换方式/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006176},{"_id":"public/2019/10/26/jdk8并发编程神器CompletableFuture初探/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006176},{"_id":"public/2019/10/20/Spring-Cloud基础微服务搭建-springboot2/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006176},{"_id":"public/2019/10/16/小组分享记录/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006176},{"_id":"public/2019/10/16/Spring-Cloud基础微服务搭建/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006176},{"_id":"public/2019/10/13/大文本文件处理-Tar命令压缩-解压缩/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006177},{"_id":"public/2019/09/30/搭建自己的linux工作环境/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006177},{"_id":"public/archives/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006177},{"_id":"public/archives/2019/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006177},{"_id":"public/archives/2019/09/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006177},{"_id":"public/archives/2019/10/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006177},{"_id":"public/archives/2019/11/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006178},{"_id":"public/categories/Mysql/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006178},{"_id":"public/categories/Java/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006178},{"_id":"public/categories/工具/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006178},{"_id":"public/categories/前端/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006178},{"_id":"public/categories/sendi趣味/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006178},{"_id":"public/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006179},{"_id":"public/tags/配置/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006179},{"_id":"public/tags/spring-cloud/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006180},{"_id":"public/tags/微服务/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006181},{"_id":"public/tags/框架搭建/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006182},{"_id":"public/tags/CompletableFuture/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006182},{"_id":"public/tags/jdk8/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006182},{"_id":"public/tags/并发编程/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006182},{"_id":"public/tags/Linux/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006183},{"_id":"public/tags/Tar/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006183},{"_id":"public/tags/压缩解压缩/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006183},{"_id":"public/tags/加密解密/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006184},{"_id":"public/tags/大文本/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006184},{"_id":"public/tags/Mysql/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006184},{"_id":"public/tags/死锁/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006184},{"_id":"public/tags/JSP/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006184},{"_id":"public/tags/EL表达式/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006185},{"_id":"public/tags/sendi/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006185},{"_id":"public/tags/linux/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006185},{"_id":"public/tags/工作环境/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1578583006185}],"Category":[{"name":"Mysql","_id":"ck56vk7cv0002wkckk61g1q31"},{"name":"Java","_id":"ck56vk7d40006wkckhuuax6hx"},{"name":"工具","_id":"ck56vk7eb000ywkcklzjldkn2"},{"name":"前端","_id":"ck56vk7ek0013wkcku19yaqja"},{"name":"sendi趣味","_id":"ck56vk7eo0016wkck9ad43xvb"}],"Data":[],"Page":[{"title":"about","date":"2019-09-30T08:29:29.000Z","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-09-30 16:29:29\n---\n","updated":"2020-01-09T13:49:32.171Z","path":"about/index.html","comments":1,"layout":"page","_id":"ck56vk7fi001swkckoth2ufvx","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Mysql常用配置","date":"2019-11-18T03:33:03.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n\n\n## 2.目的\n\n\n\n## 3.具体实施\n\n\n\n### 3.1事前准备\n\n\n\n### 3.2实施并验证\n\n**具体配置**\n\n```\n[client]\nport=3306\nsocket=/usr/local/var/mysql.sock\ndefault-character-set=utf8\n\n[mysqld]\nuser=mysql\nbind-address=0.0.0.0\nport=3306\ndatadir=/data/mysql/\nsocket=/usr/local/var/mysql.sock\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\nmax-connections=2048\nmax_connect_errors=500\nmax_allowed_packet=16M\nopen-files-limit=65536\n\ncharacter-set-server=utf8\ndefault-storage-engine=InnoDB\nlower_case_table_names=1\nsql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION\n\nserver-id=1\n\ninnodb_data_home_dir=/data/mysql/\ninnodb_file_per_table=1\ninnodb_open_files=4096\ntable_open_cache=4096\n\n#Forced autoinc locking\nbinlog_format=row\ninnodb_autoinc_lock_mode=2\n\n#load data\ninnodb_buffer_pool_size=62G\n\n\ninnodb_log_buffer_size=16M\ninnodb_log_file_size=256M\ninnodb_log_files_in_group=8\n\n\n[mysqld_safe]\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\n```\n\n## 4.为什么采用以上方式\n\n\n\n","source":"_posts/Mysql常用配置.md","raw":"---\ntitle: Mysql常用配置\ncategories:\n  - Mysql\ntags:\n  - 配置\ndate: 2019-11-18 11:33:03\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n\n\n## 2.目的\n\n\n\n## 3.具体实施\n\n\n\n### 3.1事前准备\n\n\n\n### 3.2实施并验证\n\n**具体配置**\n\n```\n[client]\nport=3306\nsocket=/usr/local/var/mysql.sock\ndefault-character-set=utf8\n\n[mysqld]\nuser=mysql\nbind-address=0.0.0.0\nport=3306\ndatadir=/data/mysql/\nsocket=/usr/local/var/mysql.sock\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\nmax-connections=2048\nmax_connect_errors=500\nmax_allowed_packet=16M\nopen-files-limit=65536\n\ncharacter-set-server=utf8\ndefault-storage-engine=InnoDB\nlower_case_table_names=1\nsql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION\n\nserver-id=1\n\ninnodb_data_home_dir=/data/mysql/\ninnodb_file_per_table=1\ninnodb_open_files=4096\ntable_open_cache=4096\n\n#Forced autoinc locking\nbinlog_format=row\ninnodb_autoinc_lock_mode=2\n\n#load data\ninnodb_buffer_pool_size=62G\n\n\ninnodb_log_buffer_size=16M\ninnodb_log_file_size=256M\ninnodb_log_files_in_group=8\n\n\n[mysqld_safe]\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\n```\n\n## 4.为什么采用以上方式\n\n\n\n","slug":"Mysql常用配置","published":1,"updated":"2020-01-09T13:49:32.057Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7ck0000wkcktsv10nz3","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>具体配置</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[client]</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">user=mysql</span><br><span class=\"line\">bind-address=0.0.0.0</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">datadir=/data/mysql/</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class=\"line\"></span><br><span class=\"line\">max-connections=2048</span><br><span class=\"line\">max_connect_errors=500</span><br><span class=\"line\">max_allowed_packet=16M</span><br><span class=\"line\">open-files-limit=65536</span><br><span class=\"line\"></span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">default-storage-engine=InnoDB</span><br><span class=\"line\">lower_case_table_names=1</span><br><span class=\"line\">sql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION</span><br><span class=\"line\"></span><br><span class=\"line\">server-id=1</span><br><span class=\"line\"></span><br><span class=\"line\">innodb_data_home_dir=/data/mysql/</span><br><span class=\"line\">innodb_file_per_table=1</span><br><span class=\"line\">innodb_open_files=4096</span><br><span class=\"line\">table_open_cache=4096</span><br><span class=\"line\"></span><br><span class=\"line\">#Forced autoinc locking</span><br><span class=\"line\">binlog_format=row</span><br><span class=\"line\">innodb_autoinc_lock_mode=2</span><br><span class=\"line\"></span><br><span class=\"line\">#load data</span><br><span class=\"line\">innodb_buffer_pool_size=62G</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">innodb_log_buffer_size=16M</span><br><span class=\"line\">innodb_log_file_size=256M</span><br><span class=\"line\">innodb_log_files_in_group=8</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld_safe]</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>具体配置</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[client]</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">user=mysql</span><br><span class=\"line\">bind-address=0.0.0.0</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">datadir=/data/mysql/</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class=\"line\"></span><br><span class=\"line\">max-connections=2048</span><br><span class=\"line\">max_connect_errors=500</span><br><span class=\"line\">max_allowed_packet=16M</span><br><span class=\"line\">open-files-limit=65536</span><br><span class=\"line\"></span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">default-storage-engine=InnoDB</span><br><span class=\"line\">lower_case_table_names=1</span><br><span class=\"line\">sql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION</span><br><span class=\"line\"></span><br><span class=\"line\">server-id=1</span><br><span class=\"line\"></span><br><span class=\"line\">innodb_data_home_dir=/data/mysql/</span><br><span class=\"line\">innodb_file_per_table=1</span><br><span class=\"line\">innodb_open_files=4096</span><br><span class=\"line\">table_open_cache=4096</span><br><span class=\"line\"></span><br><span class=\"line\">#Forced autoinc locking</span><br><span class=\"line\">binlog_format=row</span><br><span class=\"line\">innodb_autoinc_lock_mode=2</span><br><span class=\"line\"></span><br><span class=\"line\">#load data</span><br><span class=\"line\">innodb_buffer_pool_size=62G</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">innodb_log_buffer_size=16M</span><br><span class=\"line\">innodb_log_file_size=256M</span><br><span class=\"line\">innodb_log_files_in_group=8</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld_safe]</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>"},{"title":"Spring-Cloud基础微服务搭建(springboot2)","date":"2019-10-20T09:15:54.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 使用maven打包各服务](#3-2-1使用maven打包各服务)\n\t\t* [3.2.2 按照一定顺序启动各服务](#3-2-2按照一定顺序启动各服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。\n\n之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步[springboot1](https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/)\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：2.1.9.RELEASE\n\n## 3.1事前准备\n\n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n### 3.2.2 按照一定顺序启动各服务\n\njava -jar base-eureka-1.0.jar\njava -jar base-gateway-1.0.jar\njava -jar service-helloworld-1.0.jar\n\n### 3.2.3 访问接口验证\n\n直接访问接口 http://127.0.0.1:13001/helloworld\n\n通过gateway网关访问接口 http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\n\n\n","source":"_posts/Spring-Cloud基础微服务搭建-springboot2.md","raw":"---\ntitle: Spring-Cloud基础微服务搭建(springboot2)\ndate: 2019-10-20 17:15:54\ncategories:\n- Java\ntags:\n- spring-cloud\n- 微服务\n- 框架搭建\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 使用maven打包各服务](#3-2-1使用maven打包各服务)\n\t\t* [3.2.2 按照一定顺序启动各服务](#3-2-2按照一定顺序启动各服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。\n\n之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步[springboot1](https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/)\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：2.1.9.RELEASE\n\n## 3.1事前准备\n\n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n### 3.2.2 按照一定顺序启动各服务\n\njava -jar base-eureka-1.0.jar\njava -jar base-gateway-1.0.jar\njava -jar service-helloworld-1.0.jar\n\n### 3.2.3 访问接口验证\n\n直接访问接口 http://127.0.0.1:13001/helloworld\n\n通过gateway网关访问接口 http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\n\n\n","slug":"Spring-Cloud基础微服务搭建-springboot2","published":1,"updated":"2020-01-09T13:49:32.074Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7cr0001wkckvdyt7z59","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1使用maven打包各服务\">3.2.1 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-2按照一定顺序启动各服务\">3.2.2 按照一定顺序启动各服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。</p>\n<p>之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步<a href=\"https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/\" target=\"_blank\" rel=\"noopener\">springboot1</a></p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：2.1.9.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><p><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></p>\n<ul>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1使用maven打包各服务\"><a href=\"#3-2-1使用maven打包各服务\" class=\"headerlink\" title=\"3.2.1使用maven打包各服务\"></a>3.2.1使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2-按照一定顺序启动各服务\"><a href=\"#3-2-2-按照一定顺序启动各服务\" class=\"headerlink\" title=\"3.2.2 按照一定顺序启动各服务\"></a>3.2.2 按照一定顺序启动各服务</h3><p>java -jar base-eureka-1.0.jar<br>java -jar base-gateway-1.0.jar<br>java -jar service-helloworld-1.0.jar</p>\n<h3 id=\"3-2-3-访问接口验证\"><a href=\"#3-2-3-访问接口验证\" class=\"headerlink\" title=\"3.2.3 访问接口验证\"></a>3.2.3 访问接口验证</h3><p>直接访问接口 <a href=\"http://127.0.0.1:13001/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:13001/helloworld</a></p>\n<p>通过gateway网关访问接口 <a href=\"http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1使用maven打包各服务\">3.2.1 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-2按照一定顺序启动各服务\">3.2.2 按照一定顺序启动各服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。</p>\n<p>之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步<a href=\"https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/\" target=\"_blank\" rel=\"noopener\">springboot1</a></p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：2.1.9.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><p><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></p>\n<ul>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1使用maven打包各服务\"><a href=\"#3-2-1使用maven打包各服务\" class=\"headerlink\" title=\"3.2.1使用maven打包各服务\"></a>3.2.1使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2-按照一定顺序启动各服务\"><a href=\"#3-2-2-按照一定顺序启动各服务\" class=\"headerlink\" title=\"3.2.2 按照一定顺序启动各服务\"></a>3.2.2 按照一定顺序启动各服务</h3><p>java -jar base-eureka-1.0.jar<br>java -jar base-gateway-1.0.jar<br>java -jar service-helloworld-1.0.jar</p>\n<h3 id=\"3-2-3-访问接口验证\"><a href=\"#3-2-3-访问接口验证\" class=\"headerlink\" title=\"3.2.3 访问接口验证\"></a>3.2.3 访问接口验证</h3><p>直接访问接口 <a href=\"http://127.0.0.1:13001/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:13001/helloworld</a></p>\n<p>通过gateway网关访问接口 <a href=\"http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld</a></p>\n"},{"title":"Spring-Cloud基础微服务搭建(springboot1)","date":"2019-10-16T02:09:55.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 设置虚机dns](#3-2-1设置虚机dns)\n\t\t* [3.2.2 使用maven打包各服务](#3-2-2使用maven打包各服务)\n\t\t* [3.2.3 按照一定顺序执行run.sh](#3-2-3按照一定顺序执行run-sh)\n\t\t\t* [3.2.3.1 启动注册中心](#3-2-3-1启动注册中心)\n\t\t\t* [3.2.3.2 启动Zuul网关](#3-2-3-2启动Zuul网关)\n\t\t\t* [3.2.3.3 启动HelloWorld服务](#3-2-3-3启动HelloWorld服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n\n身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：1.5.19.RELEASE\n\n## 3.1事前准备\n\n* centos虚拟服务器2台: 192.168.1.150/151 \n[centos_download](https://wiki.centos.org/Download)\n* centos虚拟服务器 \n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1设置虚机dns\n\n```\n#分别在每个虚机使用root用户执行\ncat >> /etc/hosts << EOF\n192.168.1.150 spring-cloud-01\n192.168.1.151 spring-cloud-02\nEOF\n```\n\n### 3.2.2使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包\n\n把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录\n\n```\n#分别在每个虚机创建对应目录\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/resource\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/bin\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/resource\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/bin\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n**采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource\nscp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource\nscp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource\n```\n\n**用root给各个虚机上run.sh加上可执行权限**\n\n```\nchmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**解决windows环境下run.sh出现的编码问题**\n\n```\n#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**采用scp命令把处理ok的可执行文件传到其他节点**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin\nscp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin\nscp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n### 3.2.3按照一定顺序执行run.sh\n\n### 3.2.3.1启动注册中心\n\n**对不同虚机的eureka目录run.sh进行编辑**\n\n确定虚机对应的server文件\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|spring-cloud-01   |[server1](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml)      |\n|spring-cloud-02   |[server2](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml)      |\n\n```\n#登陆spring-cloud-01启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server1\n#登陆spring-cloud-02启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server2\n```\n\n**验证结果**\n\n登陆server1的[Eureka](http://192.168.1.150:12001/)，由于配置了Security，需要用户名密码，可以在配置文件查看 [点击查看](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml)\n\n若无异常会看到有两个Eureka节点已经启动\n\n![Eureka](/img/article/springcloudeureka01.png)\n\n### 3.2.3.2启动Zuul网关\n\n**登陆各虚机启动Zuul**\n\n```\n#登陆spring-cloud-01启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n#登陆spring-cloud-02启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个Zuul节点已经启动\n\n![Eureka](/img/article/springcloudzuul01.png)\n\n### 3.2.3.3启动HelloWorld服务\n\n```\n#登陆spring-cloud-01启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n#登陆spring-cloud-02启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个service-helloworld节点已经启动\n\n![Eureka](/img/article/springcloudhelloworld01.png)\n\n**通过Zuul网关访问Hello-World微服务**\n\n本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://<网关host>/<服务名>/<api>\n\n访问具体服务 http://192.168.1.150:12002/service-helloworld/helloworld\n\n![HelloWorld](/img/article/springcloudhelloworld02.png)\n\n**至此我们就已经搭建完毕一套分布式的微服务基础框架**\n\n## 4.相关说明</h2>\n\n本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步[传送门](https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/)\n\n## 5.FQA\n\n### 5.1Eureka在不同虚机为什么要采用不同配置?\n\n由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。\n\n**非常欢迎提问，所有的提问会总结写入FQA之中**","source":"_posts/Spring-Cloud基础微服务搭建.md","raw":"---\ntitle: Spring-Cloud基础微服务搭建(springboot1)\ndate: 2019-10-16 10:09:55\ncategories:\n- Java\ntags:\n- spring-cloud\n- 微服务\n- 框架搭建\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 设置虚机dns](#3-2-1设置虚机dns)\n\t\t* [3.2.2 使用maven打包各服务](#3-2-2使用maven打包各服务)\n\t\t* [3.2.3 按照一定顺序执行run.sh](#3-2-3按照一定顺序执行run-sh)\n\t\t\t* [3.2.3.1 启动注册中心](#3-2-3-1启动注册中心)\n\t\t\t* [3.2.3.2 启动Zuul网关](#3-2-3-2启动Zuul网关)\n\t\t\t* [3.2.3.3 启动HelloWorld服务](#3-2-3-3启动HelloWorld服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n\n身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：1.5.19.RELEASE\n\n## 3.1事前准备\n\n* centos虚拟服务器2台: 192.168.1.150/151 \n[centos_download](https://wiki.centos.org/Download)\n* centos虚拟服务器 \n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1设置虚机dns\n\n```\n#分别在每个虚机使用root用户执行\ncat >> /etc/hosts << EOF\n192.168.1.150 spring-cloud-01\n192.168.1.151 spring-cloud-02\nEOF\n```\n\n### 3.2.2使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包\n\n把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录\n\n```\n#分别在每个虚机创建对应目录\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/resource\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/bin\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/resource\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/bin\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n**采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource\nscp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource\nscp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource\n```\n\n**用root给各个虚机上run.sh加上可执行权限**\n\n```\nchmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**解决windows环境下run.sh出现的编码问题**\n\n```\n#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**采用scp命令把处理ok的可执行文件传到其他节点**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin\nscp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin\nscp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n### 3.2.3按照一定顺序执行run.sh\n\n### 3.2.3.1启动注册中心\n\n**对不同虚机的eureka目录run.sh进行编辑**\n\n确定虚机对应的server文件\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|spring-cloud-01   |[server1](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml)      |\n|spring-cloud-02   |[server2](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml)      |\n\n```\n#登陆spring-cloud-01启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server1\n#登陆spring-cloud-02启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server2\n```\n\n**验证结果**\n\n登陆server1的[Eureka](http://192.168.1.150:12001/)，由于配置了Security，需要用户名密码，可以在配置文件查看 [点击查看](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml)\n\n若无异常会看到有两个Eureka节点已经启动\n\n![Eureka](/img/article/springcloudeureka01.png)\n\n### 3.2.3.2启动Zuul网关\n\n**登陆各虚机启动Zuul**\n\n```\n#登陆spring-cloud-01启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n#登陆spring-cloud-02启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个Zuul节点已经启动\n\n![Eureka](/img/article/springcloudzuul01.png)\n\n### 3.2.3.3启动HelloWorld服务\n\n```\n#登陆spring-cloud-01启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n#登陆spring-cloud-02启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个service-helloworld节点已经启动\n\n![Eureka](/img/article/springcloudhelloworld01.png)\n\n**通过Zuul网关访问Hello-World微服务**\n\n本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://<网关host>/<服务名>/<api>\n\n访问具体服务 http://192.168.1.150:12002/service-helloworld/helloworld\n\n![HelloWorld](/img/article/springcloudhelloworld02.png)\n\n**至此我们就已经搭建完毕一套分布式的微服务基础框架**\n\n## 4.相关说明</h2>\n\n本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步[传送门](https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/)\n\n## 5.FQA\n\n### 5.1Eureka在不同虚机为什么要采用不同配置?\n\n由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。\n\n**非常欢迎提问，所有的提问会总结写入FQA之中**","slug":"Spring-Cloud基础微服务搭建","published":1,"updated":"2020-01-09T13:49:32.077Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7d00004wkcklhoktrn7","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1设置虚机dns\">3.2.1 设置虚机dns</a></li>\n<li><a href=\"#3-2-2使用maven打包各服务\">3.2.2 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-3按照一定顺序执行run-sh\">3.2.3 按照一定顺序执行run.sh</a><ul>\n<li><a href=\"#3-2-3-1启动注册中心\">3.2.3.1 启动注册中心</a></li>\n<li><a href=\"#3-2-3-2启动Zuul网关\">3.2.3.2 启动Zuul网关</a></li>\n<li><a href=\"#3-2-3-3启动HelloWorld服务\">3.2.3.3 启动HelloWorld服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：1.5.19.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><ul>\n<li>centos虚拟服务器2台: 192.168.1.150/151<br><a href=\"https://wiki.centos.org/Download\" target=\"_blank\" rel=\"noopener\">centos_download</a></li>\n<li>centos虚拟服务器<br><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></li>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1设置虚机dns\"><a href=\"#3-2-1设置虚机dns\" class=\"headerlink\" title=\"3.2.1设置虚机dns\"></a>3.2.1设置虚机dns</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机使用root用户执行</span><br><span class=\"line\">cat &gt;&gt; /etc/hosts &lt;&lt; EOF</span><br><span class=\"line\">192.168.1.150 spring-cloud-01</span><br><span class=\"line\">192.168.1.151 spring-cloud-02</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2使用maven打包各服务\"><a href=\"#3-2-2使用maven打包各服务\" class=\"headerlink\" title=\"3.2.2使用maven打包各服务\"></a>3.2.2使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<p>以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包</p>\n<p>把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机创建对应目录</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br></pre></td></tr></table></figure>\n\n<p><strong>用root给各个虚机上run.sh加上可执行权限</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决windows环境下run.sh出现的编码问题</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把处理ok的可执行文件传到其他节点</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-3按照一定顺序执行run-sh\"><a href=\"#3-2-3按照一定顺序执行run-sh\" class=\"headerlink\" title=\"3.2.3按照一定顺序执行run.sh\"></a>3.2.3按照一定顺序执行run.sh</h3><h3 id=\"3-2-3-1启动注册中心\"><a href=\"#3-2-3-1启动注册中心\" class=\"headerlink\" title=\"3.2.3.1启动注册中心\"></a>3.2.3.1启动注册中心</h3><p><strong>对不同虚机的eureka目录run.sh进行编辑</strong></p>\n<p>确定虚机对应的server文件</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">spring-cloud-01</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml\" target=\"_blank\" rel=\"noopener\">server1</a></td>\n</tr>\n<tr>\n<td align=\"center\">spring-cloud-02</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml\" target=\"_blank\" rel=\"noopener\">server2</a></td>\n</tr>\n</tbody></table>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server1</span><br><span class=\"line\">#登陆spring-cloud-02启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server2</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>登陆server1的<a href=\"http://192.168.1.150:12001/\" target=\"_blank\" rel=\"noopener\">Eureka</a>，由于配置了Security，需要用户名密码，可以在配置文件查看 <a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml\" target=\"_blank\" rel=\"noopener\">点击查看</a></p>\n<p>若无异常会看到有两个Eureka节点已经启动</p>\n<p><img src=\"/img/article/springcloudeureka01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-2启动Zuul网关\"><a href=\"#3-2-3-2启动Zuul网关\" class=\"headerlink\" title=\"3.2.3.2启动Zuul网关\"></a>3.2.3.2启动Zuul网关</h3><p><strong>登陆各虚机启动Zuul</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个Zuul节点已经启动</p>\n<p><img src=\"/img/article/springcloudzuul01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-3启动HelloWorld服务\"><a href=\"#3-2-3-3启动HelloWorld服务\" class=\"headerlink\" title=\"3.2.3.3启动HelloWorld服务\"></a>3.2.3.3启动HelloWorld服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个service-helloworld节点已经启动</p>\n<p><img src=\"/img/article/springcloudhelloworld01.png\" alt=\"Eureka\"></p>\n<p><strong>通过Zuul网关访问Hello-World微服务</strong></p>\n<p>本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://&lt;网关host&gt;/&lt;服务名&gt;/<api></api></p>\n<p>访问具体服务 <a href=\"http://192.168.1.150:12002/service-helloworld/helloworld\" target=\"_blank\" rel=\"noopener\">http://192.168.1.150:12002/service-helloworld/helloworld</a></p>\n<p><img src=\"/img/article/springcloudhelloworld02.png\" alt=\"HelloWorld\"></p>\n<p><strong>至此我们就已经搭建完毕一套分布式的微服务基础框架</strong></p>\n<h2 id=\"4-相关说明\"><a href=\"#4-相关说明\" class=\"headerlink\" title=\"4.相关说明\"></a>4.相关说明</h2><p>本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步<a href=\"https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/\" target=\"_blank\" rel=\"noopener\">传送门</a></p>\n<h2 id=\"5-FQA\"><a href=\"#5-FQA\" class=\"headerlink\" title=\"5.FQA\"></a>5.FQA</h2><h3 id=\"5-1Eureka在不同虚机为什么要采用不同配置\"><a href=\"#5-1Eureka在不同虚机为什么要采用不同配置\" class=\"headerlink\" title=\"5.1Eureka在不同虚机为什么要采用不同配置?\"></a>5.1Eureka在不同虚机为什么要采用不同配置?</h3><p>由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。</p>\n<p><strong>非常欢迎提问，所有的提问会总结写入FQA之中</strong></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1设置虚机dns\">3.2.1 设置虚机dns</a></li>\n<li><a href=\"#3-2-2使用maven打包各服务\">3.2.2 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-3按照一定顺序执行run-sh\">3.2.3 按照一定顺序执行run.sh</a><ul>\n<li><a href=\"#3-2-3-1启动注册中心\">3.2.3.1 启动注册中心</a></li>\n<li><a href=\"#3-2-3-2启动Zuul网关\">3.2.3.2 启动Zuul网关</a></li>\n<li><a href=\"#3-2-3-3启动HelloWorld服务\">3.2.3.3 启动HelloWorld服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：1.5.19.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><ul>\n<li>centos虚拟服务器2台: 192.168.1.150/151<br><a href=\"https://wiki.centos.org/Download\" target=\"_blank\" rel=\"noopener\">centos_download</a></li>\n<li>centos虚拟服务器<br><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></li>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1设置虚机dns\"><a href=\"#3-2-1设置虚机dns\" class=\"headerlink\" title=\"3.2.1设置虚机dns\"></a>3.2.1设置虚机dns</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机使用root用户执行</span><br><span class=\"line\">cat &gt;&gt; /etc/hosts &lt;&lt; EOF</span><br><span class=\"line\">192.168.1.150 spring-cloud-01</span><br><span class=\"line\">192.168.1.151 spring-cloud-02</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2使用maven打包各服务\"><a href=\"#3-2-2使用maven打包各服务\" class=\"headerlink\" title=\"3.2.2使用maven打包各服务\"></a>3.2.2使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<p>以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包</p>\n<p>把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机创建对应目录</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br></pre></td></tr></table></figure>\n\n<p><strong>用root给各个虚机上run.sh加上可执行权限</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决windows环境下run.sh出现的编码问题</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把处理ok的可执行文件传到其他节点</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-3按照一定顺序执行run-sh\"><a href=\"#3-2-3按照一定顺序执行run-sh\" class=\"headerlink\" title=\"3.2.3按照一定顺序执行run.sh\"></a>3.2.3按照一定顺序执行run.sh</h3><h3 id=\"3-2-3-1启动注册中心\"><a href=\"#3-2-3-1启动注册中心\" class=\"headerlink\" title=\"3.2.3.1启动注册中心\"></a>3.2.3.1启动注册中心</h3><p><strong>对不同虚机的eureka目录run.sh进行编辑</strong></p>\n<p>确定虚机对应的server文件</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">spring-cloud-01</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml\" target=\"_blank\" rel=\"noopener\">server1</a></td>\n</tr>\n<tr>\n<td align=\"center\">spring-cloud-02</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml\" target=\"_blank\" rel=\"noopener\">server2</a></td>\n</tr>\n</tbody></table>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server1</span><br><span class=\"line\">#登陆spring-cloud-02启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server2</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>登陆server1的<a href=\"http://192.168.1.150:12001/\" target=\"_blank\" rel=\"noopener\">Eureka</a>，由于配置了Security，需要用户名密码，可以在配置文件查看 <a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml\" target=\"_blank\" rel=\"noopener\">点击查看</a></p>\n<p>若无异常会看到有两个Eureka节点已经启动</p>\n<p><img src=\"/img/article/springcloudeureka01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-2启动Zuul网关\"><a href=\"#3-2-3-2启动Zuul网关\" class=\"headerlink\" title=\"3.2.3.2启动Zuul网关\"></a>3.2.3.2启动Zuul网关</h3><p><strong>登陆各虚机启动Zuul</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个Zuul节点已经启动</p>\n<p><img src=\"/img/article/springcloudzuul01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-3启动HelloWorld服务\"><a href=\"#3-2-3-3启动HelloWorld服务\" class=\"headerlink\" title=\"3.2.3.3启动HelloWorld服务\"></a>3.2.3.3启动HelloWorld服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个service-helloworld节点已经启动</p>\n<p><img src=\"/img/article/springcloudhelloworld01.png\" alt=\"Eureka\"></p>\n<p><strong>通过Zuul网关访问Hello-World微服务</strong></p>\n<p>本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://&lt;网关host&gt;/&lt;服务名&gt;/<api></api></p>\n<p>访问具体服务 <a href=\"http://192.168.1.150:12002/service-helloworld/helloworld\" target=\"_blank\" rel=\"noopener\">http://192.168.1.150:12002/service-helloworld/helloworld</a></p>\n<p><img src=\"/img/article/springcloudhelloworld02.png\" alt=\"HelloWorld\"></p>\n<p><strong>至此我们就已经搭建完毕一套分布式的微服务基础框架</strong></p>\n<h2 id=\"4-相关说明\"><a href=\"#4-相关说明\" class=\"headerlink\" title=\"4.相关说明\"></a>4.相关说明</h2><p>本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步<a href=\"https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/\" target=\"_blank\" rel=\"noopener\">传送门</a></p>\n<h2 id=\"5-FQA\"><a href=\"#5-FQA\" class=\"headerlink\" title=\"5.FQA\"></a>5.FQA</h2><h3 id=\"5-1Eureka在不同虚机为什么要采用不同配置\"><a href=\"#5-1Eureka在不同虚机为什么要采用不同配置\" class=\"headerlink\" title=\"5.1Eureka在不同虚机为什么要采用不同配置?\"></a>5.1Eureka在不同虚机为什么要采用不同配置?</h3><p>由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。</p>\n<p><strong>非常欢迎提问，所有的提问会总结写入FQA之中</strong></p>\n"},{"title":"jdk8并发编程神器CompletableFuture初探","date":"2019-10-26T08:22:52.000Z","_content":"\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 并发打印helloworld](#3-2-1并发打印helloworld)\n\t\t* [3.2.2 并发协作](#3-2-2并发协作)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类--CompletableFuture。\n之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。\n\n\n## 2.目的\n\n能够根据案例正确的使用CompletableFuture来解决相关并发问题。\n\n## 3.具体实施\n\n### 3.1事前准备\n\n* 了解线程基础知识\n* 了解lambda表达式\n* 了解函数式编程\n* 了解CountDownLatch\n\n### 3.2实施并验证\n\n**基础方法**\n\n|方法  | 说明 | 线程有无返回值|\n| :----------:| :-----------:| :-----------:|\n| runAsync() | 异步运行一个线程 | 无 |\n| supplyAsync() | 异步运行一个线程 | 有 |\n| thenAcceptAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 无 |\n| thenApplyAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 有 |\n\n\n#### 3.2.1并发打印helloworld\n\n采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束\n\n```\nfinal int times = 10;\nfinal CountDownLatch countDownLatch = new CountDownLatch(times);\nfor (int i = 0; i < 10; i++) {\n\tCompletableFuture.runAsync(()->{\n\t\tSystem.out.println(\"Hello World. \" + Thread.currentThread().getName() + \": \" \n\t\t\t\t+ Thread.currentThread().getId() + \" \" + LocalTime.now());\n\t\tcountDownLatch.countDown();\n\t});\n}\ncountDownLatch.await();\n```\n\n运行可得到:\n\n```\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\n```\n\n#### 3.2.2并发协作\n\n\n## 4.为什么采用以上方式\n\n\n\n\n","source":"_posts/jdk8并发编程神器CompletableFuture初探.md","raw":"---\ntitle: jdk8并发编程神器CompletableFuture初探\ndate: 2019-10-26 16:22:52\ncategories:\n- Java\ntags:\n- CompletableFuture\n- jdk8\n- 并发编程\n---\n\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 并发打印helloworld](#3-2-1并发打印helloworld)\n\t\t* [3.2.2 并发协作](#3-2-2并发协作)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类--CompletableFuture。\n之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。\n\n\n## 2.目的\n\n能够根据案例正确的使用CompletableFuture来解决相关并发问题。\n\n## 3.具体实施\n\n### 3.1事前准备\n\n* 了解线程基础知识\n* 了解lambda表达式\n* 了解函数式编程\n* 了解CountDownLatch\n\n### 3.2实施并验证\n\n**基础方法**\n\n|方法  | 说明 | 线程有无返回值|\n| :----------:| :-----------:| :-----------:|\n| runAsync() | 异步运行一个线程 | 无 |\n| supplyAsync() | 异步运行一个线程 | 有 |\n| thenAcceptAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 无 |\n| thenApplyAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 有 |\n\n\n#### 3.2.1并发打印helloworld\n\n采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束\n\n```\nfinal int times = 10;\nfinal CountDownLatch countDownLatch = new CountDownLatch(times);\nfor (int i = 0; i < 10; i++) {\n\tCompletableFuture.runAsync(()->{\n\t\tSystem.out.println(\"Hello World. \" + Thread.currentThread().getName() + \": \" \n\t\t\t\t+ Thread.currentThread().getId() + \" \" + LocalTime.now());\n\t\tcountDownLatch.countDown();\n\t});\n}\ncountDownLatch.await();\n```\n\n运行可得到:\n\n```\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\n```\n\n#### 3.2.2并发协作\n\n\n## 4.为什么采用以上方式\n\n\n\n\n","slug":"jdk8并发编程神器CompletableFuture初探","published":1,"updated":"2020-01-09T13:49:32.081Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7d20005wkck6s1uc7ui","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1并发打印helloworld\">3.2.1 并发打印helloworld</a></li>\n<li><a href=\"#3-2-2并发协作\">3.2.2 并发协作</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类–CompletableFuture。<br>之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据案例正确的使用CompletableFuture来解决相关并发问题。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><ul>\n<li>了解线程基础知识</li>\n<li>了解lambda表达式</li>\n<li>了解函数式编程</li>\n<li>了解CountDownLatch</li>\n</ul>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>基础方法</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">方法</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">线程有无返回值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">runAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">supplyAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n<tr>\n<td align=\"center\">thenAcceptAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">thenApplyAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-2-1并发打印helloworld\"><a href=\"#3-2-1并发打印helloworld\" class=\"headerlink\" title=\"3.2.1并发打印helloworld\"></a>3.2.1并发打印helloworld</h4><p>采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">final int times = 10;</span><br><span class=\"line\">final CountDownLatch countDownLatch = new CountDownLatch(times);</span><br><span class=\"line\">for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class=\"line\">\tCompletableFuture.runAsync(()-&gt;&#123;</span><br><span class=\"line\">\t\tSystem.out.println(&quot;Hello World. &quot; + Thread.currentThread().getName() + &quot;: &quot; </span><br><span class=\"line\">\t\t\t\t+ Thread.currentThread().getId() + &quot; &quot; + LocalTime.now());</span><br><span class=\"line\">\t\tcountDownLatch.countDown();</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">countDownLatch.await();</span><br></pre></td></tr></table></figure>\n\n<p>运行可得到:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-2-2并发协作\"><a href=\"#3-2-2并发协作\" class=\"headerlink\" title=\"3.2.2并发协作\"></a>3.2.2并发协作</h4><h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1并发打印helloworld\">3.2.1 并发打印helloworld</a></li>\n<li><a href=\"#3-2-2并发协作\">3.2.2 并发协作</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类–CompletableFuture。<br>之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据案例正确的使用CompletableFuture来解决相关并发问题。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><ul>\n<li>了解线程基础知识</li>\n<li>了解lambda表达式</li>\n<li>了解函数式编程</li>\n<li>了解CountDownLatch</li>\n</ul>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>基础方法</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">方法</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">线程有无返回值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">runAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">supplyAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n<tr>\n<td align=\"center\">thenAcceptAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">thenApplyAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-2-1并发打印helloworld\"><a href=\"#3-2-1并发打印helloworld\" class=\"headerlink\" title=\"3.2.1并发打印helloworld\"></a>3.2.1并发打印helloworld</h4><p>采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">final int times = 10;</span><br><span class=\"line\">final CountDownLatch countDownLatch = new CountDownLatch(times);</span><br><span class=\"line\">for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class=\"line\">\tCompletableFuture.runAsync(()-&gt;&#123;</span><br><span class=\"line\">\t\tSystem.out.println(&quot;Hello World. &quot; + Thread.currentThread().getName() + &quot;: &quot; </span><br><span class=\"line\">\t\t\t\t+ Thread.currentThread().getId() + &quot; &quot; + LocalTime.now());</span><br><span class=\"line\">\t\tcountDownLatch.countDown();</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">countDownLatch.await();</span><br></pre></td></tr></table></figure>\n\n<p>运行可得到:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-2-2并发协作\"><a href=\"#3-2-2并发协作\" class=\"headerlink\" title=\"3.2.2并发协作\"></a>3.2.2并发协作</h4><h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>"},{"title":"大文本文件处理-Tar命令压缩_解压缩","date":"2019-10-13T03:37:34.000Z","_content":"\n\n### 目录\n* [1.缘由](#缘由)\n* [2.目的](#目的)\n* [3.具体实施](#目的)\n    * [3.1 准备工具](#准备工具)\n    * [3.2 实施并验证](#实施并验证)\n* [4.为什么采用以上方式](#为什么采用以上方式)\n\n## 缘由\n\n近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，\n首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。\n\n## 目的\n\n在Linux中对大本文文件进行压缩，并加密解密\n\n## 具体实施\n\n## 准备工具\n\n* 系统：centos7\n* 工具包: tar,openssl\n* 待处理的文件: test.txt (本文准备的文件大小在4G左右)\n\n## 实施并验证\n\ntar指令核心参数：\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|-j   |以bzip2方式压缩      |\n|-z   |以gzip方式压缩      |\n|-c   |建立新的备份文件      |\n|-f   |指定备份文件      |\n|-v   |显示指令执行过程      |\n|-x   |从备份文件中还原文件      |\n\n\n\n**1.使用tar进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.tar.bz2 ./test.txt\n\n解压： tar -jxf ./test.tar.bz2\n```\n\n**2.使用tar + openssl进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.txt | openssl des3 -salt -k <password> -out ./test.tar.bz2\n\n解压： openssl des3 -d -k <password> -salt -in /test.tar.bz2 | tar jxf -\n```\n\n## 为什么采用以上方式\n\n**采用bzip2**\n\n相对于gzip压缩速度慢，但压缩效果好\n\n**采用gzip**\n\n相对bzip2压缩速度快，但压缩效果差\n\n**对比实例**\n\n压缩981M的text.txt\n\n**gzip：**\n\ntime tar  -zcvf ./test.tar.gz ./test.txt\n\nreal    0m22.177s\nuser    0m21.874s\nsys     0m1.006s\n\n131M test.tar.gz\n\n**bzip2：**\n\ntime tar -jcvf test.tar.bz2 ./test.txt\n\nreal    3m1.416s\nuser    3m0.875s\nsys     0m1.638s\n\n99M test.tar.bz2","source":"_posts/大文本文件处理-Tar命令压缩-解压缩.md","raw":"---\ntitle: 大文本文件处理-Tar命令压缩_解压缩\ndate: 2019-10-13 11:37:34\ncategories:\n- 工具\ntags:\n- Linux\n- Tar\n- 压缩解压缩\n- 加密解密\n- 大文本\n---\n\n\n### 目录\n* [1.缘由](#缘由)\n* [2.目的](#目的)\n* [3.具体实施](#目的)\n    * [3.1 准备工具](#准备工具)\n    * [3.2 实施并验证](#实施并验证)\n* [4.为什么采用以上方式](#为什么采用以上方式)\n\n## 缘由\n\n近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，\n首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。\n\n## 目的\n\n在Linux中对大本文文件进行压缩，并加密解密\n\n## 具体实施\n\n## 准备工具\n\n* 系统：centos7\n* 工具包: tar,openssl\n* 待处理的文件: test.txt (本文准备的文件大小在4G左右)\n\n## 实施并验证\n\ntar指令核心参数：\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|-j   |以bzip2方式压缩      |\n|-z   |以gzip方式压缩      |\n|-c   |建立新的备份文件      |\n|-f   |指定备份文件      |\n|-v   |显示指令执行过程      |\n|-x   |从备份文件中还原文件      |\n\n\n\n**1.使用tar进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.tar.bz2 ./test.txt\n\n解压： tar -jxf ./test.tar.bz2\n```\n\n**2.使用tar + openssl进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.txt | openssl des3 -salt -k <password> -out ./test.tar.bz2\n\n解压： openssl des3 -d -k <password> -salt -in /test.tar.bz2 | tar jxf -\n```\n\n## 为什么采用以上方式\n\n**采用bzip2**\n\n相对于gzip压缩速度慢，但压缩效果好\n\n**采用gzip**\n\n相对bzip2压缩速度快，但压缩效果差\n\n**对比实例**\n\n压缩981M的text.txt\n\n**gzip：**\n\ntime tar  -zcvf ./test.tar.gz ./test.txt\n\nreal    0m22.177s\nuser    0m21.874s\nsys     0m1.006s\n\n131M test.tar.gz\n\n**bzip2：**\n\ntime tar -jcvf test.tar.bz2 ./test.txt\n\nreal    3m1.416s\nuser    3m0.875s\nsys     0m1.638s\n\n99M test.tar.bz2","slug":"大文本文件处理-Tar命令压缩-解压缩","published":1,"updated":"2020-01-09T13:49:32.123Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7e7000wwkckfe7gb5uf","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#缘由\">1.缘由</a></li>\n<li><a href=\"#目的\">2.目的</a></li>\n<li><a href=\"#目的\">3.具体实施</a><ul>\n<li><a href=\"#准备工具\">3.1 准备工具</a></li>\n<li><a href=\"#实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，<br>首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>在Linux中对大本文文件进行压缩，并加密解密</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><h2 id=\"准备工具\"><a href=\"#准备工具\" class=\"headerlink\" title=\"准备工具\"></a>准备工具</h2><ul>\n<li>系统：centos7</li>\n<li>工具包: tar,openssl</li>\n<li>待处理的文件: test.txt (本文准备的文件大小在4G左右)</li>\n</ul>\n<h2 id=\"实施并验证\"><a href=\"#实施并验证\" class=\"headerlink\" title=\"实施并验证\"></a>实施并验证</h2><p>tar指令核心参数：</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-j</td>\n<td align=\"center\">以bzip2方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-z</td>\n<td align=\"center\">以gzip方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-c</td>\n<td align=\"center\">建立新的备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-f</td>\n<td align=\"center\">指定备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-v</td>\n<td align=\"center\">显示指令执行过程</td>\n</tr>\n<tr>\n<td align=\"center\">-x</td>\n<td align=\"center\">从备份文件中还原文件</td>\n</tr>\n</tbody></table>\n<p><strong>1.使用tar进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.tar.bz2 ./test.txt</span><br><span class=\"line\"></span><br><span class=\"line\">解压： tar -jxf ./test.tar.bz2</span><br></pre></td></tr></table></figure>\n\n<p><strong>2.使用tar + openssl进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.txt | openssl des3 -salt -k &lt;password&gt; -out ./test.tar.bz2</span><br><span class=\"line\"></span><br><span class=\"line\">解压： openssl des3 -d -k &lt;password&gt; -salt -in /test.tar.bz2 | tar jxf -</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"为什么采用以上方式\"><a href=\"#为什么采用以上方式\" class=\"headerlink\" title=\"为什么采用以上方式\"></a>为什么采用以上方式</h2><p><strong>采用bzip2</strong></p>\n<p>相对于gzip压缩速度慢，但压缩效果好</p>\n<p><strong>采用gzip</strong></p>\n<p>相对bzip2压缩速度快，但压缩效果差</p>\n<p><strong>对比实例</strong></p>\n<p>压缩981M的text.txt</p>\n<p><strong>gzip：</strong></p>\n<p>time tar  -zcvf ./test.tar.gz ./test.txt</p>\n<p>real    0m22.177s<br>user    0m21.874s<br>sys     0m1.006s</p>\n<p>131M test.tar.gz</p>\n<p><strong>bzip2：</strong></p>\n<p>time tar -jcvf test.tar.bz2 ./test.txt</p>\n<p>real    3m1.416s<br>user    3m0.875s<br>sys     0m1.638s</p>\n<p>99M test.tar.bz2</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#缘由\">1.缘由</a></li>\n<li><a href=\"#目的\">2.目的</a></li>\n<li><a href=\"#目的\">3.具体实施</a><ul>\n<li><a href=\"#准备工具\">3.1 准备工具</a></li>\n<li><a href=\"#实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，<br>首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>在Linux中对大本文文件进行压缩，并加密解密</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><h2 id=\"准备工具\"><a href=\"#准备工具\" class=\"headerlink\" title=\"准备工具\"></a>准备工具</h2><ul>\n<li>系统：centos7</li>\n<li>工具包: tar,openssl</li>\n<li>待处理的文件: test.txt (本文准备的文件大小在4G左右)</li>\n</ul>\n<h2 id=\"实施并验证\"><a href=\"#实施并验证\" class=\"headerlink\" title=\"实施并验证\"></a>实施并验证</h2><p>tar指令核心参数：</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-j</td>\n<td align=\"center\">以bzip2方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-z</td>\n<td align=\"center\">以gzip方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-c</td>\n<td align=\"center\">建立新的备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-f</td>\n<td align=\"center\">指定备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-v</td>\n<td align=\"center\">显示指令执行过程</td>\n</tr>\n<tr>\n<td align=\"center\">-x</td>\n<td align=\"center\">从备份文件中还原文件</td>\n</tr>\n</tbody></table>\n<p><strong>1.使用tar进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.tar.bz2 ./test.txt</span><br><span class=\"line\"></span><br><span class=\"line\">解压： tar -jxf ./test.tar.bz2</span><br></pre></td></tr></table></figure>\n\n<p><strong>2.使用tar + openssl进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.txt | openssl des3 -salt -k &lt;password&gt; -out ./test.tar.bz2</span><br><span class=\"line\"></span><br><span class=\"line\">解压： openssl des3 -d -k &lt;password&gt; -salt -in /test.tar.bz2 | tar jxf -</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"为什么采用以上方式\"><a href=\"#为什么采用以上方式\" class=\"headerlink\" title=\"为什么采用以上方式\"></a>为什么采用以上方式</h2><p><strong>采用bzip2</strong></p>\n<p>相对于gzip压缩速度慢，但压缩效果好</p>\n<p><strong>采用gzip</strong></p>\n<p>相对bzip2压缩速度快，但压缩效果差</p>\n<p><strong>对比实例</strong></p>\n<p>压缩981M的text.txt</p>\n<p><strong>gzip：</strong></p>\n<p>time tar  -zcvf ./test.tar.gz ./test.txt</p>\n<p>real    0m22.177s<br>user    0m21.874s<br>sys     0m1.006s</p>\n<p>131M test.tar.gz</p>\n<p><strong>bzip2：</strong></p>\n<p>time tar -jcvf test.tar.bz2 ./test.txt</p>\n<p>real    3m1.416s<br>user    3m0.875s<br>sys     0m1.638s</p>\n<p>99M test.tar.bz2</p>\n"},{"title":"一次mysql死锁记录","date":"2019-11-24T08:51:49.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体过程](#3-具体过程)\n\n## 1.缘由\n\n由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录\n\n## 2.目的\n\n提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况\n\n## 3.具体过程\n\nMysql版本: 5.7.25\n\n发生死锁的表：\n```\nCREATE TABLE `table_example` (\n  `dname` varchar(100) DEFAULT '',\n  `subname` varchar(100) DEFAULT '',\n  `data2` varchar(100) DEFAULT '',\n  `data3` varchar(100) DEFAULT '',\n  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY `subname` (`subname`),\n  KEY `capturetime` (`capturetime`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 \n```\n\n产生死锁的语句：\n```\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n```\n\n**怎么发现死锁的**\n\n执行sql运行情况检索非sleep状态的sql\n```\nshow OPEN TABLES where In_use > 0;\nselect id, db, user, host, command, time, state, info from \ninformation_schema.processlist where command != 'Sleep'  order by time desc;\n```\n\n检查到很多执行时间很长的sql\n\n再执行Innodb死锁检测\n```\nshow engine innodb status;\n```\n\n查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录\n\n```\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2019-11-18 15:38:35 0x7fca119b8700\n*** (1) TRANSACTION:\nTRANSACTION 72276684, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) TRANSACTION:\nTRANSACTION 72276687, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\n16 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data2.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n```\n\n**分析死锁原因**\n\n从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。\n\n![](./img/article/dead_lock01.png)\n\n由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。\n\n**锁类型是否能共存**\n\n| type | X | IX | S | IS |\n| :----------:| :-----------:|  :-----------:|  :-----------:|  :-----------:| \n| X | × | × | × | × |\n| IX | × | √ | × | √ |\n| S | × | × | √ | √ |\n| IS | × | √ | √ | √ |\n\nGEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。\n\n**解决**\n\n1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。\n\n2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。\n\n\n","source":"_posts/一次mysql死锁记录.md","raw":"---\ntitle: 一次mysql死锁记录\ncategories:\n  - Mysql\ntags:\n  - Mysql\n  - 死锁\ndate: 2019-11-24 16:51:49\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体过程](#3-具体过程)\n\n## 1.缘由\n\n由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录\n\n## 2.目的\n\n提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况\n\n## 3.具体过程\n\nMysql版本: 5.7.25\n\n发生死锁的表：\n```\nCREATE TABLE `table_example` (\n  `dname` varchar(100) DEFAULT '',\n  `subname` varchar(100) DEFAULT '',\n  `data2` varchar(100) DEFAULT '',\n  `data3` varchar(100) DEFAULT '',\n  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY `subname` (`subname`),\n  KEY `capturetime` (`capturetime`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 \n```\n\n产生死锁的语句：\n```\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n```\n\n**怎么发现死锁的**\n\n执行sql运行情况检索非sleep状态的sql\n```\nshow OPEN TABLES where In_use > 0;\nselect id, db, user, host, command, time, state, info from \ninformation_schema.processlist where command != 'Sleep'  order by time desc;\n```\n\n检查到很多执行时间很长的sql\n\n再执行Innodb死锁检测\n```\nshow engine innodb status;\n```\n\n查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录\n\n```\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2019-11-18 15:38:35 0x7fca119b8700\n*** (1) TRANSACTION:\nTRANSACTION 72276684, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) TRANSACTION:\nTRANSACTION 72276687, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\n16 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data2.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n```\n\n**分析死锁原因**\n\n从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。\n\n![](./img/article/dead_lock01.png)\n\n由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。\n\n**锁类型是否能共存**\n\n| type | X | IX | S | IS |\n| :----------:| :-----------:|  :-----------:|  :-----------:|  :-----------:| \n| X | × | × | × | × |\n| IX | × | √ | × | √ |\n| S | × | × | √ | √ |\n| IS | × | √ | √ | √ |\n\nGEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。\n\n**解决**\n\n1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。\n\n2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。\n\n\n","slug":"一次mysql死锁记录","published":1,"updated":"2020-01-09T13:49:32.105Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7e9000xwkckew11cez0","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体过程\">3.具体过程</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况</p>\n<h2 id=\"3-具体过程\"><a href=\"#3-具体过程\" class=\"headerlink\" title=\"3.具体过程\"></a>3.具体过程</h2><p>Mysql版本: 5.7.25</p>\n<p>发生死锁的表：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `table_example` (</span><br><span class=\"line\">  `dname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `subname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data2` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data3` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</span><br><span class=\"line\">  KEY `subname` (`subname`),</span><br><span class=\"line\">  KEY `capturetime` (`capturetime`),</span><br><span class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8</span><br></pre></td></tr></table></figure>\n\n<p>产生死锁的语句：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br></pre></td></tr></table></figure>\n\n<p><strong>怎么发现死锁的</strong></p>\n<p>执行sql运行情况检索非sleep状态的sql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show OPEN TABLES where In_use &gt; 0;</span><br><span class=\"line\">select id, db, user, host, command, time, state, info from </span><br><span class=\"line\">information_schema.processlist where command != &apos;Sleep&apos;  order by time desc;</span><br></pre></td></tr></table></figure>\n\n<p>检查到很多执行时间很长的sql</p>\n<p>再执行Innodb死锁检测</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show engine innodb status;</span><br></pre></td></tr></table></figure>\n\n<p>查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">------------------------</span><br><span class=\"line\">LATEST DETECTED DEADLOCK</span><br><span class=\"line\">------------------------</span><br><span class=\"line\">2019-11-18 15:38:35 0x7fca119b8700</span><br><span class=\"line\">*** (1) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276684, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">LOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276687, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">16 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data2.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (2) HOLDS THE LOCK(S):</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br></pre></td></tr></table></figure>\n\n<p><strong>分析死锁原因</strong></p>\n<p>从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。</p>\n<p><img src=\"./img/article/dead_lock01.png\" alt></p>\n<p>由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。</p>\n<p><strong>锁类型是否能共存</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">type</th>\n<th align=\"center\">X</th>\n<th align=\"center\">IX</th>\n<th align=\"center\">S</th>\n<th align=\"center\">IS</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">X</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n</tr>\n<tr>\n<td align=\"center\">IX</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">IS</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n</tbody></table>\n<p>GEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。</p>\n<p><strong>解决</strong></p>\n<p>1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。</p>\n<p>2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体过程\">3.具体过程</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况</p>\n<h2 id=\"3-具体过程\"><a href=\"#3-具体过程\" class=\"headerlink\" title=\"3.具体过程\"></a>3.具体过程</h2><p>Mysql版本: 5.7.25</p>\n<p>发生死锁的表：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `table_example` (</span><br><span class=\"line\">  `dname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `subname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data2` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data3` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</span><br><span class=\"line\">  KEY `subname` (`subname`),</span><br><span class=\"line\">  KEY `capturetime` (`capturetime`),</span><br><span class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8</span><br></pre></td></tr></table></figure>\n\n<p>产生死锁的语句：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br></pre></td></tr></table></figure>\n\n<p><strong>怎么发现死锁的</strong></p>\n<p>执行sql运行情况检索非sleep状态的sql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show OPEN TABLES where In_use &gt; 0;</span><br><span class=\"line\">select id, db, user, host, command, time, state, info from </span><br><span class=\"line\">information_schema.processlist where command != &apos;Sleep&apos;  order by time desc;</span><br></pre></td></tr></table></figure>\n\n<p>检查到很多执行时间很长的sql</p>\n<p>再执行Innodb死锁检测</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show engine innodb status;</span><br></pre></td></tr></table></figure>\n\n<p>查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">------------------------</span><br><span class=\"line\">LATEST DETECTED DEADLOCK</span><br><span class=\"line\">------------------------</span><br><span class=\"line\">2019-11-18 15:38:35 0x7fca119b8700</span><br><span class=\"line\">*** (1) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276684, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">LOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276687, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">16 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data2.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (2) HOLDS THE LOCK(S):</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br></pre></td></tr></table></figure>\n\n<p><strong>分析死锁原因</strong></p>\n<p>从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。</p>\n<p><img src=\"./img/article/dead_lock01.png\" alt></p>\n<p>由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。</p>\n<p><strong>锁类型是否能共存</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">type</th>\n<th align=\"center\">X</th>\n<th align=\"center\">IX</th>\n<th align=\"center\">S</th>\n<th align=\"center\">IS</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">X</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n</tr>\n<tr>\n<td align=\"center\">IX</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">IS</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n</tbody></table>\n<p>GEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。</p>\n<p><strong>解决</strong></p>\n<p>1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。</p>\n<p>2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。</p>\n"},{"title":"JSP转HTML中EL表达式替换方式","date":"2019-11-06T09:12:20.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。\n\n## 2.目的\n\n能把包含EL表达式的JSP转化为HTML\n\n## 3.具体实施\n\n采用HandleBar前端插件替换EL表达式。\n\n### 3.1事前准备\n\nHandleBar基础用法\n\n### 3.2实施并验证\n\n**将一个用EL表达式写的导航转化为HandleBar来做**\n\n**源EL表达式：**\n```\n<!--菜单输出开始-->\n<ul id=\"menu_ul\">\n<c:forEach var=\"firstMenu\" items=\"${menus}\" varStatus=\"status\">\n  <li class=\"second\" <c:if test=\"${!empty firstMenu.URL}\"> \n  onclick=\"navClick('${firstMenu.ID}','${firstMenu.NAME}',\n    <c:choose>\n      <c:when test=\"${fn:startsWith(firstMenu.URL, 'http')}\">\n      '${firstMenu.URL}'</c:when>\n      <c:otherwise>webRoot + '${firstMenu.URL}'</c:otherwise>\n    </c:choose> )\"</c:if>>\n    <!--一级菜单输出-->\n    <c:choose>\n      <c:when test=\"${fn:contains(firstMenu.iconClass, '/')}\">\n        <img src=\"<%=webRoot%>${firstMenu.iconClass}\" />\n      </c:when>\n      <c:otherwise>\n        <i class='<c:if test=\"${!empty firstMenu.iconClass}\">\n        ${firstMenu.iconClass}</c:if>\n        <c:if test=\"${empty firstMenu.iconClass}\">icon-map-marker</c:if>'\n        title='${firstMenu.NAME}'></i>\n      </c:otherwise>\n    </c:choose>\n    <p>${firstMenu.NAME}</p>\n\n    <!-- 二层 -->\n    <ul>\n      <c:forEach var=\"secondMenu\" items=\"${firstMenu.senconds}\">\n        <li <c:if test=\"${!empty secondMenu.URL}\"> \n        onclick=\"navClick('${secondMenu.ID}','${secondMenu.NAME}',\n          <c:choose>\n            <c:when test=\"${fn:startsWith(secondMenu.URL, 'http')}\">\n      '${secondMenu.URL}'</c:when>\n            <c:otherwise>webRoot + '${secondMenu.URL}'</c:otherwise>\n          </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty secondMenu.iconClass}\">\n      ${secondMenu.iconClass}</c:if>\n      <c:if test=\"${empty secondMenu.iconClass}\">icon-info-sign\n      </c:if>'></i>\n          <span>${secondMenu.NAME}\n            <c:if test=\"${!empty secondMenu.thirds}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty secondMenu.thirds}\">\n\n            <c:if test=\"${secondMenu.haveFourth!=1}\">\n\n              <!-- 三层 -->\n              <ul class='fourth'>\n\n                <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                  <!--三级菜单输出-->\n                  <li class='third orange width2 height1' \n          <c:if test=\"${!empty thirdMenu.URL}\"> \n          onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                    <c:choose>\n                      <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n            '${thirdMenu.URL}'</c:when>\n                      <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                    </c:choose> )\"</c:if>>\n\n            <span>${thirdMenu.NAME}</span>\n            <img src=\"<%=webRoot%>/page/images/img.png\" \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n            </li>\n            </c:forEach>\n            </ul>\n\n          </c:if>\n\n          <c:if test=\"${secondMenu.haveFourth==1}\">\n            <ul class=\"thirds\">\n              <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                <!--三级菜单输出-->\n                <li <c:if test=\"${!empty thirdMenu.URL}\"> \n        onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n          '${thirdMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty thirdMenu.iconClass}\">\n      ${thirdMenu.iconClass}</c:if>\n      <c:if test=\"${empty thirdMenu.iconClass}\">icon-info-sign</c:if>'></i>\n          <span>${thirdMenu.NAME}\n            <c:if test=\"${!empty thirdMenu.fourths}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty thirdMenu.fourths}\">\n\n            <ul class='fourth'>\n              <c:forEach var=\"fourthMenu\" items=\"${thirdMenu.fourths}\">\n                <li class='third orange width2 height1' \n        <c:if test=\"${!empty fourthMenu.URL}\"> \n        onclick=\"navClick('${fourthMenu.ID}','${fourthMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(fourthMenu.URL, 'http')}\">\n          '${fourthMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${fourthMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <span>${fourthMenu.NAME}</span>\n          <img src=\"<%=webRoot%>/page/images/img.png\"  \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </c:if>\n        </li>\n\n      </c:forEach>\n    </ul>\n  </li>\n</c:forEach>\n</ul>\n```\n\n**更改之后的HandleBar表达式**\n```\n<script id=\"menu_html\" type=\"text/x-handlebars-template\">\n{{!-- 菜单输出开始 --}}\n{{#each menus}}\n\n{{!-- 一级菜单输出 --}}\n{{#if URL}}\n<li class=\"second\" onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n  {{else}}\n<li class=\"second\">\n  {{/if}}\n\n  {{#if iconImg}}\n  <img src=\"{{iconImg}}\"/>\n  {{else}}\n  {{#if iconClass}}\n  <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n  {{else}}\n  <i class=\"icon-map-marker\" title=\"{{NAME}}\"></i>\n  {{/if}}\n  {{/if}}\n\n\n  <p>{{NAME}}</p>\n\n  {{!-- 二级菜单输出 --}}\n  <ul>\n    {{#each seconds}}\n\n    {{#if URL}}\n    <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n      {{else}}\n    <li>\n      {{/if}}\n\n      {{#if iconClass}}\n      <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n      {{else}}\n      <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n      {{/if}}\n\n      {{#if thirds}}\n      <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n      {{else}}\n      <span>{{NAME}}</span>\n      {{/if}}\n\n      {{!-- 三级菜单输出 --}}\n      {{#if haveFourth}}\n      <ul class=\"thirds\">\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n\n          {{#if iconClass}}\n          <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n          {{else}}\n          <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n          {{/if}}\n\n          {{#if fourths}}\n          <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n          <ul class='fourth'>\n            {{#each fourths}}\n            {{#if URL}}\n            <li class='third orange width2 height1' \n      onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n              {{else}}\n            <li>\n              {{/if}}\n              <span>{{NAME}}</span>\n              <img src=\"./images/nav_default.jpg\" \n        onerror=\"this.src='./images/unvisited.png'\"/>\n            </li>\n            {{/each}}\n\n          </ul>\n          {{else}}\n          <span>{{NAME}}</span>\n          {{/if}}\n          {{/each}}\n      </ul>\n\n      {{else}}\n\n      {{#if thirds}}\n      <ul class='fourth'>\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li class='third orange width2 height1' \n    onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n          <span>{{NAME}}</span>\n          <img src=\"./images/nav_default.jpg\" \n      onerror=\"this.src='./images/unvisited.png'\"/>\n        </li>\n        {{/each}}\n      </ul>\n      {{/if}}\n\n      {{/if}}\n\n    </li>\n    {{/each}}\n  </ul>\n\n</li>\n{{/each}}\n</script>\n```\n\n**HandleBar模板以及原始数据的js处理：**\n```\n\n    $.post('http://xxx?menus', '', function (data) {\n        eachFirstNav(data.menus);\n\n        var menuHTML = $(\"#menu_html\").html();\n        var template = Handlebars.compile(menuHTML);\n        var html = template(data);\n\n        let menuDom = $('#menu_ul');\n        menuDom.html(html);\n\n        navInit01();\n    }, 'json')\n\n    function eachFirstNav(data) {\n\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].iconClass.indexOf('/') !== -1){\n                data[item].iconImg = webRoot + data[item].iconClass\n            }\n            if (data[item].URL !== '' ) {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachSecondsNav(data[item].seconds);\n            }\n        }\n    }\n\n    function eachSecondsNav(data) {\n        for(let item in data){\n            /*若有4层导航，样式等需要替换，由于HandleBar的\n      IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/\n            if (data[item].haveFourth === -1) {\n                data[item].haveFourth = '';\n            }\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachThirdsNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachThirdsNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachFourthNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachFourthNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                return;\n            }\n        }\n    }\n```\n\n**源测试数据:**\n```\n{\n  \"menus\": [\n    {\n      \"ID\": \"a25b2t4aastb\",\n      \"CREATEDATETIME\": 1484647359000,\n      \"DESCRIPTION\": \"\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \" 视图管理\",\n      \"SEQ\": 5,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1503631792000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"\",\n      \"iconClass\": \"icon-sitemap\\t\",\n      \"seconds\": [\n        {\n          \"ID\": \"ab542b5b25a\",\n          \"CREATEDATETIME\": 1517818707000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"ext-icon-folder_user\",\n          \"NAME\": \"用户视图\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1517818707000,\n          \"URL\": \"http://www.baidu.com\",\n          \"SYRESOURCE_ID\": \"haerhh123515\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": -1,\n          \"thirds\": []\n        }\n      ]\n    },\n    {\n      \"ID\": \"fawfaf244\",\n      \"CREATEDATETIME\": 1458248395000,\n      \"DESCRIPTION\": \"管理系统的资源、角色、机构、用户等信息\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \"系统管理\",\n      \"SEQ\": 40,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1502706964000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"xxx-color-blue\",\n      \"iconClass\": \"/page/image/icon_leftmenu09.png\",\n      \"seconds\": [\n        {\n          \"ID\": \"afawfa2\",\n          \"CREATEDATETIME\": 1503633639000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"\",\n          \"NAME\": \"系统维护\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1503633639000,\n          \"URL\": \"\",\n          \"SYRESOURCE_ID\": \"a22ab3wb2\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": 1,\n          \"thirds\": [\n            {\n              \"ID\": \"afa2fa\",\n              \"CREATEDATETIME\": 1466414417000,\n              \"DESCRIPTION\": \"\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"功能使用统计\",\n              \"SEQ\": 4,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1503633686000,\n              \"URL\": \"/xxx.do?ba32b522\",\n              \"SYRESOURCE_ID\": \"a2b5235\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"color\": \"\",\n              \"iconClass\": \"icon-unlock-alt\",\n              \"fourths\": []\n            },\n            {\n              \"ID\": \"afa2f2a445\",\n              \"CREATEDATETIME\": 1504236483000,\n              \"DESCRIPTION\": \"数据库监控相关操作\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"数据库监控\",\n              \"SEQ\": 14,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1504236483000,\n              \"URL\": \"\",\n              \"SYRESOURCE_ID\": \"SYRESOURCE_IDxx\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"fourths\": [\n                {\n                  \"ID\": \"2bab525\",\n                  \"CREATEDATETIME\": 1504236647000,\n                  \"DESCRIPTION\": \"数据库信息查看\",\n                  \"ICONCLS\": \"\",\n                  \"NAME\": \"数据库信息查看\",\n                  \"SEQ\": 1,\n                  \"TARGET\": \"\",\n                  \"UPDATEDATETIME\": 1504236782000,\n                  \"URL\": \"/xxx.do?xxx\",\n                  \"SYRESOURCE_ID\": \"SYRESOURCE_IDawdwa\",\n                  \"SYRESOURCETYPE_ID\": \"0\"\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n## 4.为什么采用以上方式\n\n此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。\n\n\n","source":"_posts/JSP转HTML中EL表达式替换方式.md","raw":"---\ntitle: JSP转HTML中EL表达式替换方式\ncategories:\n  - 前端\ntags:\n  - JSP\n  - EL表达式\ndate: 2019-11-06 17:12:20\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。\n\n## 2.目的\n\n能把包含EL表达式的JSP转化为HTML\n\n## 3.具体实施\n\n采用HandleBar前端插件替换EL表达式。\n\n### 3.1事前准备\n\nHandleBar基础用法\n\n### 3.2实施并验证\n\n**将一个用EL表达式写的导航转化为HandleBar来做**\n\n**源EL表达式：**\n```\n<!--菜单输出开始-->\n<ul id=\"menu_ul\">\n<c:forEach var=\"firstMenu\" items=\"${menus}\" varStatus=\"status\">\n  <li class=\"second\" <c:if test=\"${!empty firstMenu.URL}\"> \n  onclick=\"navClick('${firstMenu.ID}','${firstMenu.NAME}',\n    <c:choose>\n      <c:when test=\"${fn:startsWith(firstMenu.URL, 'http')}\">\n      '${firstMenu.URL}'</c:when>\n      <c:otherwise>webRoot + '${firstMenu.URL}'</c:otherwise>\n    </c:choose> )\"</c:if>>\n    <!--一级菜单输出-->\n    <c:choose>\n      <c:when test=\"${fn:contains(firstMenu.iconClass, '/')}\">\n        <img src=\"<%=webRoot%>${firstMenu.iconClass}\" />\n      </c:when>\n      <c:otherwise>\n        <i class='<c:if test=\"${!empty firstMenu.iconClass}\">\n        ${firstMenu.iconClass}</c:if>\n        <c:if test=\"${empty firstMenu.iconClass}\">icon-map-marker</c:if>'\n        title='${firstMenu.NAME}'></i>\n      </c:otherwise>\n    </c:choose>\n    <p>${firstMenu.NAME}</p>\n\n    <!-- 二层 -->\n    <ul>\n      <c:forEach var=\"secondMenu\" items=\"${firstMenu.senconds}\">\n        <li <c:if test=\"${!empty secondMenu.URL}\"> \n        onclick=\"navClick('${secondMenu.ID}','${secondMenu.NAME}',\n          <c:choose>\n            <c:when test=\"${fn:startsWith(secondMenu.URL, 'http')}\">\n      '${secondMenu.URL}'</c:when>\n            <c:otherwise>webRoot + '${secondMenu.URL}'</c:otherwise>\n          </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty secondMenu.iconClass}\">\n      ${secondMenu.iconClass}</c:if>\n      <c:if test=\"${empty secondMenu.iconClass}\">icon-info-sign\n      </c:if>'></i>\n          <span>${secondMenu.NAME}\n            <c:if test=\"${!empty secondMenu.thirds}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty secondMenu.thirds}\">\n\n            <c:if test=\"${secondMenu.haveFourth!=1}\">\n\n              <!-- 三层 -->\n              <ul class='fourth'>\n\n                <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                  <!--三级菜单输出-->\n                  <li class='third orange width2 height1' \n          <c:if test=\"${!empty thirdMenu.URL}\"> \n          onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                    <c:choose>\n                      <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n            '${thirdMenu.URL}'</c:when>\n                      <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                    </c:choose> )\"</c:if>>\n\n            <span>${thirdMenu.NAME}</span>\n            <img src=\"<%=webRoot%>/page/images/img.png\" \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n            </li>\n            </c:forEach>\n            </ul>\n\n          </c:if>\n\n          <c:if test=\"${secondMenu.haveFourth==1}\">\n            <ul class=\"thirds\">\n              <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                <!--三级菜单输出-->\n                <li <c:if test=\"${!empty thirdMenu.URL}\"> \n        onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n          '${thirdMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty thirdMenu.iconClass}\">\n      ${thirdMenu.iconClass}</c:if>\n      <c:if test=\"${empty thirdMenu.iconClass}\">icon-info-sign</c:if>'></i>\n          <span>${thirdMenu.NAME}\n            <c:if test=\"${!empty thirdMenu.fourths}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty thirdMenu.fourths}\">\n\n            <ul class='fourth'>\n              <c:forEach var=\"fourthMenu\" items=\"${thirdMenu.fourths}\">\n                <li class='third orange width2 height1' \n        <c:if test=\"${!empty fourthMenu.URL}\"> \n        onclick=\"navClick('${fourthMenu.ID}','${fourthMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(fourthMenu.URL, 'http')}\">\n          '${fourthMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${fourthMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <span>${fourthMenu.NAME}</span>\n          <img src=\"<%=webRoot%>/page/images/img.png\"  \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </c:if>\n        </li>\n\n      </c:forEach>\n    </ul>\n  </li>\n</c:forEach>\n</ul>\n```\n\n**更改之后的HandleBar表达式**\n```\n<script id=\"menu_html\" type=\"text/x-handlebars-template\">\n{{!-- 菜单输出开始 --}}\n{{#each menus}}\n\n{{!-- 一级菜单输出 --}}\n{{#if URL}}\n<li class=\"second\" onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n  {{else}}\n<li class=\"second\">\n  {{/if}}\n\n  {{#if iconImg}}\n  <img src=\"{{iconImg}}\"/>\n  {{else}}\n  {{#if iconClass}}\n  <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n  {{else}}\n  <i class=\"icon-map-marker\" title=\"{{NAME}}\"></i>\n  {{/if}}\n  {{/if}}\n\n\n  <p>{{NAME}}</p>\n\n  {{!-- 二级菜单输出 --}}\n  <ul>\n    {{#each seconds}}\n\n    {{#if URL}}\n    <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n      {{else}}\n    <li>\n      {{/if}}\n\n      {{#if iconClass}}\n      <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n      {{else}}\n      <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n      {{/if}}\n\n      {{#if thirds}}\n      <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n      {{else}}\n      <span>{{NAME}}</span>\n      {{/if}}\n\n      {{!-- 三级菜单输出 --}}\n      {{#if haveFourth}}\n      <ul class=\"thirds\">\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n\n          {{#if iconClass}}\n          <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n          {{else}}\n          <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n          {{/if}}\n\n          {{#if fourths}}\n          <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n          <ul class='fourth'>\n            {{#each fourths}}\n            {{#if URL}}\n            <li class='third orange width2 height1' \n      onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n              {{else}}\n            <li>\n              {{/if}}\n              <span>{{NAME}}</span>\n              <img src=\"./images/nav_default.jpg\" \n        onerror=\"this.src='./images/unvisited.png'\"/>\n            </li>\n            {{/each}}\n\n          </ul>\n          {{else}}\n          <span>{{NAME}}</span>\n          {{/if}}\n          {{/each}}\n      </ul>\n\n      {{else}}\n\n      {{#if thirds}}\n      <ul class='fourth'>\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li class='third orange width2 height1' \n    onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n          <span>{{NAME}}</span>\n          <img src=\"./images/nav_default.jpg\" \n      onerror=\"this.src='./images/unvisited.png'\"/>\n        </li>\n        {{/each}}\n      </ul>\n      {{/if}}\n\n      {{/if}}\n\n    </li>\n    {{/each}}\n  </ul>\n\n</li>\n{{/each}}\n</script>\n```\n\n**HandleBar模板以及原始数据的js处理：**\n```\n\n    $.post('http://xxx?menus', '', function (data) {\n        eachFirstNav(data.menus);\n\n        var menuHTML = $(\"#menu_html\").html();\n        var template = Handlebars.compile(menuHTML);\n        var html = template(data);\n\n        let menuDom = $('#menu_ul');\n        menuDom.html(html);\n\n        navInit01();\n    }, 'json')\n\n    function eachFirstNav(data) {\n\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].iconClass.indexOf('/') !== -1){\n                data[item].iconImg = webRoot + data[item].iconClass\n            }\n            if (data[item].URL !== '' ) {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachSecondsNav(data[item].seconds);\n            }\n        }\n    }\n\n    function eachSecondsNav(data) {\n        for(let item in data){\n            /*若有4层导航，样式等需要替换，由于HandleBar的\n      IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/\n            if (data[item].haveFourth === -1) {\n                data[item].haveFourth = '';\n            }\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachThirdsNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachThirdsNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachFourthNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachFourthNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                return;\n            }\n        }\n    }\n```\n\n**源测试数据:**\n```\n{\n  \"menus\": [\n    {\n      \"ID\": \"a25b2t4aastb\",\n      \"CREATEDATETIME\": 1484647359000,\n      \"DESCRIPTION\": \"\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \" 视图管理\",\n      \"SEQ\": 5,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1503631792000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"\",\n      \"iconClass\": \"icon-sitemap\\t\",\n      \"seconds\": [\n        {\n          \"ID\": \"ab542b5b25a\",\n          \"CREATEDATETIME\": 1517818707000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"ext-icon-folder_user\",\n          \"NAME\": \"用户视图\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1517818707000,\n          \"URL\": \"http://www.baidu.com\",\n          \"SYRESOURCE_ID\": \"haerhh123515\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": -1,\n          \"thirds\": []\n        }\n      ]\n    },\n    {\n      \"ID\": \"fawfaf244\",\n      \"CREATEDATETIME\": 1458248395000,\n      \"DESCRIPTION\": \"管理系统的资源、角色、机构、用户等信息\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \"系统管理\",\n      \"SEQ\": 40,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1502706964000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"xxx-color-blue\",\n      \"iconClass\": \"/page/image/icon_leftmenu09.png\",\n      \"seconds\": [\n        {\n          \"ID\": \"afawfa2\",\n          \"CREATEDATETIME\": 1503633639000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"\",\n          \"NAME\": \"系统维护\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1503633639000,\n          \"URL\": \"\",\n          \"SYRESOURCE_ID\": \"a22ab3wb2\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": 1,\n          \"thirds\": [\n            {\n              \"ID\": \"afa2fa\",\n              \"CREATEDATETIME\": 1466414417000,\n              \"DESCRIPTION\": \"\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"功能使用统计\",\n              \"SEQ\": 4,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1503633686000,\n              \"URL\": \"/xxx.do?ba32b522\",\n              \"SYRESOURCE_ID\": \"a2b5235\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"color\": \"\",\n              \"iconClass\": \"icon-unlock-alt\",\n              \"fourths\": []\n            },\n            {\n              \"ID\": \"afa2f2a445\",\n              \"CREATEDATETIME\": 1504236483000,\n              \"DESCRIPTION\": \"数据库监控相关操作\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"数据库监控\",\n              \"SEQ\": 14,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1504236483000,\n              \"URL\": \"\",\n              \"SYRESOURCE_ID\": \"SYRESOURCE_IDxx\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"fourths\": [\n                {\n                  \"ID\": \"2bab525\",\n                  \"CREATEDATETIME\": 1504236647000,\n                  \"DESCRIPTION\": \"数据库信息查看\",\n                  \"ICONCLS\": \"\",\n                  \"NAME\": \"数据库信息查看\",\n                  \"SEQ\": 1,\n                  \"TARGET\": \"\",\n                  \"UPDATEDATETIME\": 1504236782000,\n                  \"URL\": \"/xxx.do?xxx\",\n                  \"SYRESOURCE_ID\": \"SYRESOURCE_IDawdwa\",\n                  \"SYRESOURCETYPE_ID\": \"0\"\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n## 4.为什么采用以上方式\n\n此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。\n\n\n","slug":"JSP转HTML中EL表达式替换方式","published":1,"updated":"2020-01-09T13:49:32.054Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7ee0010wkckbmcc0g8o","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能把包含EL表达式的JSP转化为HTML</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>采用HandleBar前端插件替换EL表达式。</p>\n<h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>HandleBar基础用法</p>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>将一个用EL表达式写的导航转化为HandleBar来做</strong></p>\n<p><strong>源EL表达式：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--菜单输出开始--&gt;</span><br><span class=\"line\">&lt;ul id=&quot;menu_ul&quot;&gt;</span><br><span class=\"line\">&lt;c:forEach var=&quot;firstMenu&quot; items=&quot;$&#123;menus&#125;&quot; varStatus=&quot;status&quot;&gt;</span><br><span class=\"line\">  &lt;li class=&quot;second&quot; &lt;c:if test=&quot;$&#123;!empty firstMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">  onclick=&quot;navClick(&apos;$&#123;firstMenu.ID&#125;&apos;,&apos;$&#123;firstMenu.NAME&#125;&apos;,</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:startsWith(firstMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;webRoot + &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">    &lt;!--一级菜单输出--&gt;</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:contains(firstMenu.iconClass, &apos;/&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;img src=&quot;&lt;%=webRoot%&gt;$&#123;firstMenu.iconClass&#125;&quot; /&gt;</span><br><span class=\"line\">      &lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;</span><br><span class=\"line\">        &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty firstMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">        $&#123;firstMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;empty firstMenu.iconClass&#125;&quot;&gt;icon-map-marker&lt;/c:if&gt;&apos;</span><br><span class=\"line\">        title=&apos;$&#123;firstMenu.NAME&#125;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt;</span><br><span class=\"line\">    &lt;p&gt;$&#123;firstMenu.NAME&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 二层 --&gt;</span><br><span class=\"line\">    &lt;ul&gt;</span><br><span class=\"line\">      &lt;c:forEach var=&quot;secondMenu&quot; items=&quot;$&#123;firstMenu.senconds&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;li &lt;c:if test=&quot;$&#123;!empty secondMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;secondMenu.ID&#125;&apos;,&apos;$&#123;secondMenu.NAME&#125;&apos;,</span><br><span class=\"line\">          &lt;c:choose&gt;</span><br><span class=\"line\">            &lt;c:when test=&quot;$&#123;fn:startsWith(secondMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">            &lt;c:otherwise&gt;webRoot + &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">          &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty secondMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;secondMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty secondMenu.iconClass&#125;&quot;&gt;icon-info-sign</span><br><span class=\"line\">      &lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;secondMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;secondMenu.haveFourth!=1&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">              &lt;!-- 三层 --&gt;</span><br><span class=\"line\">              &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">                &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                  &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                  &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">          onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                    &lt;c:choose&gt;</span><br><span class=\"line\">                      &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">            &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                      &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;span&gt;$&#123;thirdMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">            &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &lt;/c:forEach&gt;</span><br><span class=\"line\">            &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;secondMenu.haveFourth==1&#125;&quot;&gt;</span><br><span class=\"line\">            &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                &lt;li &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty thirdMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;thirdMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty thirdMenu.iconClass&#125;&quot;&gt;icon-info-sign&lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;thirdMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;fourthMenu&quot; items=&quot;$&#123;thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;!empty fourthMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;fourthMenu.ID&#125;&apos;,&apos;$&#123;fourthMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(fourthMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;fourthMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot;  </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &lt;/c:forEach&gt;</span><br><span class=\"line\">    &lt;/ul&gt;</span><br><span class=\"line\">  &lt;/li&gt;</span><br><span class=\"line\">&lt;/c:forEach&gt;</span><br><span class=\"line\">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>更改之后的HandleBar表达式</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script id=&quot;menu_html&quot; type=&quot;text/x-handlebars-template&quot;&gt;</span><br><span class=\"line\">&#123;&#123;!-- 菜单输出开始 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#each menus&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;!-- 一级菜单输出 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot; onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;#if iconImg&#125;&#125;</span><br><span class=\"line\">  &lt;img src=&quot;&#123;&#123;iconImg&#125;&#125;&quot;/&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;icon-map-marker&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;p&gt;&#123;&#123;NAME&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;!-- 二级菜单输出 --&#125;&#125;</span><br><span class=\"line\">  &lt;ul&gt;</span><br><span class=\"line\">    &#123;&#123;#each seconds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">    &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">    &lt;li&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;!-- 三级菜单输出 --&#125;&#125;</span><br><span class=\"line\">      &#123;&#123;#if haveFourth&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if fourths&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">          &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">            &#123;&#123;#each fourths&#125;&#125;</span><br><span class=\"line\">            &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">            &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">      onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">              &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">            &lt;li&gt;</span><br><span class=\"line\">              &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">              &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">              &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">        onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">    onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\">        &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/li&gt;</span><br><span class=\"line\">    &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">  &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/li&gt;</span><br><span class=\"line\">&#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>HandleBar模板以及原始数据的js处理：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$.post(&apos;http://xxx?menus&apos;, &apos;&apos;, function (data) &#123;</span><br><span class=\"line\">    eachFirstNav(data.menus);</span><br><span class=\"line\"></span><br><span class=\"line\">    var menuHTML = $(&quot;#menu_html&quot;).html();</span><br><span class=\"line\">    var template = Handlebars.compile(menuHTML);</span><br><span class=\"line\">    var html = template(data);</span><br><span class=\"line\"></span><br><span class=\"line\">    let menuDom = $(&apos;#menu_ul&apos;);</span><br><span class=\"line\">    menuDom.html(html);</span><br><span class=\"line\"></span><br><span class=\"line\">    navInit01();</span><br><span class=\"line\">&#125;, &apos;json&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFirstNav(data) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].iconClass.indexOf(&apos;/&apos;) !== -1)&#123;</span><br><span class=\"line\">            data[item].iconImg = webRoot + data[item].iconClass</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos; ) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachSecondsNav(data[item].seconds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachSecondsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        /*若有4层导航，样式等需要替换，由于HandleBar的</span><br><span class=\"line\">  IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/</span><br><span class=\"line\">        if (data[item].haveFourth === -1) &#123;</span><br><span class=\"line\">            data[item].haveFourth = &apos;&apos;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachThirdsNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachThirdsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachFourthNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFourthNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            return;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>源测试数据:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;menus&quot;: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;a25b2t4aastb&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1484647359000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot; 视图管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 5,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1503631792000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;icon-sitemap\\t&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;ab542b5b25a&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;ext-icon-folder_user&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;用户视图&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;http://www.baidu.com&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;haerhh123515&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: -1,</span><br><span class=\"line\">          &quot;thirds&quot;: []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;fawfaf244&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1458248395000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;管理系统的资源、角色、机构、用户等信息&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot;系统管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 40,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1502706964000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;xxx-color-blue&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;/page/image/icon_leftmenu09.png&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;afawfa2&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;系统维护&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;a22ab3wb2&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: 1,</span><br><span class=\"line\">          &quot;thirds&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2fa&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1466414417000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;功能使用统计&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 4,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1503633686000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;/xxx.do?ba32b522&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;a2b5235&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;iconClass&quot;: &quot;icon-unlock-alt&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: []</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2f2a445&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;数据库监控相关操作&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;数据库监控&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 14,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDxx&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                  &quot;ID&quot;: &quot;2bab525&quot;,</span><br><span class=\"line\">                  &quot;CREATEDATETIME&quot;: 1504236647000,</span><br><span class=\"line\">                  &quot;DESCRIPTION&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;NAME&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;SEQ&quot;: 1,</span><br><span class=\"line\">                  &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;UPDATEDATETIME&quot;: 1504236782000,</span><br><span class=\"line\">                  &quot;URL&quot;: &quot;/xxx.do?xxx&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDawdwa&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              ]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2><p>此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能把包含EL表达式的JSP转化为HTML</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>采用HandleBar前端插件替换EL表达式。</p>\n<h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>HandleBar基础用法</p>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>将一个用EL表达式写的导航转化为HandleBar来做</strong></p>\n<p><strong>源EL表达式：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--菜单输出开始--&gt;</span><br><span class=\"line\">&lt;ul id=&quot;menu_ul&quot;&gt;</span><br><span class=\"line\">&lt;c:forEach var=&quot;firstMenu&quot; items=&quot;$&#123;menus&#125;&quot; varStatus=&quot;status&quot;&gt;</span><br><span class=\"line\">  &lt;li class=&quot;second&quot; &lt;c:if test=&quot;$&#123;!empty firstMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">  onclick=&quot;navClick(&apos;$&#123;firstMenu.ID&#125;&apos;,&apos;$&#123;firstMenu.NAME&#125;&apos;,</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:startsWith(firstMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;webRoot + &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">    &lt;!--一级菜单输出--&gt;</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:contains(firstMenu.iconClass, &apos;/&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;img src=&quot;&lt;%=webRoot%&gt;$&#123;firstMenu.iconClass&#125;&quot; /&gt;</span><br><span class=\"line\">      &lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;</span><br><span class=\"line\">        &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty firstMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">        $&#123;firstMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;empty firstMenu.iconClass&#125;&quot;&gt;icon-map-marker&lt;/c:if&gt;&apos;</span><br><span class=\"line\">        title=&apos;$&#123;firstMenu.NAME&#125;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt;</span><br><span class=\"line\">    &lt;p&gt;$&#123;firstMenu.NAME&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 二层 --&gt;</span><br><span class=\"line\">    &lt;ul&gt;</span><br><span class=\"line\">      &lt;c:forEach var=&quot;secondMenu&quot; items=&quot;$&#123;firstMenu.senconds&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;li &lt;c:if test=&quot;$&#123;!empty secondMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;secondMenu.ID&#125;&apos;,&apos;$&#123;secondMenu.NAME&#125;&apos;,</span><br><span class=\"line\">          &lt;c:choose&gt;</span><br><span class=\"line\">            &lt;c:when test=&quot;$&#123;fn:startsWith(secondMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">            &lt;c:otherwise&gt;webRoot + &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">          &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty secondMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;secondMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty secondMenu.iconClass&#125;&quot;&gt;icon-info-sign</span><br><span class=\"line\">      &lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;secondMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;secondMenu.haveFourth!=1&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">              &lt;!-- 三层 --&gt;</span><br><span class=\"line\">              &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">                &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                  &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                  &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">          onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                    &lt;c:choose&gt;</span><br><span class=\"line\">                      &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">            &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                      &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;span&gt;$&#123;thirdMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">            &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &lt;/c:forEach&gt;</span><br><span class=\"line\">            &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;secondMenu.haveFourth==1&#125;&quot;&gt;</span><br><span class=\"line\">            &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                &lt;li &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty thirdMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;thirdMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty thirdMenu.iconClass&#125;&quot;&gt;icon-info-sign&lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;thirdMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;fourthMenu&quot; items=&quot;$&#123;thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;!empty fourthMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;fourthMenu.ID&#125;&apos;,&apos;$&#123;fourthMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(fourthMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;fourthMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot;  </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &lt;/c:forEach&gt;</span><br><span class=\"line\">    &lt;/ul&gt;</span><br><span class=\"line\">  &lt;/li&gt;</span><br><span class=\"line\">&lt;/c:forEach&gt;</span><br><span class=\"line\">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>更改之后的HandleBar表达式</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script id=&quot;menu_html&quot; type=&quot;text/x-handlebars-template&quot;&gt;</span><br><span class=\"line\">&#123;&#123;!-- 菜单输出开始 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#each menus&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;!-- 一级菜单输出 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot; onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;#if iconImg&#125;&#125;</span><br><span class=\"line\">  &lt;img src=&quot;&#123;&#123;iconImg&#125;&#125;&quot;/&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;icon-map-marker&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;p&gt;&#123;&#123;NAME&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;!-- 二级菜单输出 --&#125;&#125;</span><br><span class=\"line\">  &lt;ul&gt;</span><br><span class=\"line\">    &#123;&#123;#each seconds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">    &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">    &lt;li&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;!-- 三级菜单输出 --&#125;&#125;</span><br><span class=\"line\">      &#123;&#123;#if haveFourth&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if fourths&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">          &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">            &#123;&#123;#each fourths&#125;&#125;</span><br><span class=\"line\">            &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">            &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">      onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">              &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">            &lt;li&gt;</span><br><span class=\"line\">              &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">              &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">              &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">        onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">    onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\">        &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/li&gt;</span><br><span class=\"line\">    &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">  &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/li&gt;</span><br><span class=\"line\">&#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>HandleBar模板以及原始数据的js处理：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$.post(&apos;http://xxx?menus&apos;, &apos;&apos;, function (data) &#123;</span><br><span class=\"line\">    eachFirstNav(data.menus);</span><br><span class=\"line\"></span><br><span class=\"line\">    var menuHTML = $(&quot;#menu_html&quot;).html();</span><br><span class=\"line\">    var template = Handlebars.compile(menuHTML);</span><br><span class=\"line\">    var html = template(data);</span><br><span class=\"line\"></span><br><span class=\"line\">    let menuDom = $(&apos;#menu_ul&apos;);</span><br><span class=\"line\">    menuDom.html(html);</span><br><span class=\"line\"></span><br><span class=\"line\">    navInit01();</span><br><span class=\"line\">&#125;, &apos;json&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFirstNav(data) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].iconClass.indexOf(&apos;/&apos;) !== -1)&#123;</span><br><span class=\"line\">            data[item].iconImg = webRoot + data[item].iconClass</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos; ) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachSecondsNav(data[item].seconds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachSecondsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        /*若有4层导航，样式等需要替换，由于HandleBar的</span><br><span class=\"line\">  IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/</span><br><span class=\"line\">        if (data[item].haveFourth === -1) &#123;</span><br><span class=\"line\">            data[item].haveFourth = &apos;&apos;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachThirdsNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachThirdsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachFourthNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFourthNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            return;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>源测试数据:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;menus&quot;: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;a25b2t4aastb&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1484647359000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot; 视图管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 5,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1503631792000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;icon-sitemap\\t&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;ab542b5b25a&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;ext-icon-folder_user&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;用户视图&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;http://www.baidu.com&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;haerhh123515&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: -1,</span><br><span class=\"line\">          &quot;thirds&quot;: []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;fawfaf244&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1458248395000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;管理系统的资源、角色、机构、用户等信息&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot;系统管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 40,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1502706964000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;xxx-color-blue&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;/page/image/icon_leftmenu09.png&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;afawfa2&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;系统维护&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;a22ab3wb2&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: 1,</span><br><span class=\"line\">          &quot;thirds&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2fa&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1466414417000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;功能使用统计&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 4,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1503633686000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;/xxx.do?ba32b522&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;a2b5235&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;iconClass&quot;: &quot;icon-unlock-alt&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: []</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2f2a445&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;数据库监控相关操作&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;数据库监控&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 14,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDxx&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                  &quot;ID&quot;: &quot;2bab525&quot;,</span><br><span class=\"line\">                  &quot;CREATEDATETIME&quot;: 1504236647000,</span><br><span class=\"line\">                  &quot;DESCRIPTION&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;NAME&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;SEQ&quot;: 1,</span><br><span class=\"line\">                  &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;UPDATEDATETIME&quot;: 1504236782000,</span><br><span class=\"line\">                  &quot;URL&quot;: &quot;/xxx.do?xxx&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDawdwa&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              ]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2><p>此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。</p>\n"},{"title":"小组分享记录(持续更新)","date":"2019-10-16T11:51:57.000Z","_content":"\n### 目录\n\n* [1.记录](#记录)\n* [2.缘由](#缘由)\n* [3.目的](#目的)\n* [4.具体实施](#具体实施)\n\n## 记录\n\n### Todo需求记录\n* jsp-->>html √\n* spring-cloud √ spring-cloud-02(springboot2) √\n* Vue √ Vue-02(组件化)\n* Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 \n* NIO √ NIO-02\n* NodeJs\n* Dubbo\n* Kafka\n\n### 2019-12-11\n\n小S同学12-11分享 \"Mysql锁机制\"\n\n小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”\n\n确定小秀同学2019-12-25分享“Vue-02组件化”\n\n### 2019-12-04\n\n小F同学12-04分享\"spring-cloud-02(springboot2) skywalking简单使用\"\n\n小H同学提出需求\"Kafka\"\n\n确认小H同学2019-12-18分享\"WebService服务调用\"\n\n### 2019-11-27\n\n小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n小F同学提出需求 \"NIO - 02\"\n\n确认小S同学12-11分享 \"Mysql锁机制\"\n\n### 2019-11-20\n\n小秀同学分享\"vue项目创建过程\"\n\n小F同学提出需求 \"Vue-02(组件化)\"\n\n小S同学提出需求 \"Mysql锁机制\"\n\n小广同学提出需求 \"spring-cloud-02(springboot2)\"\n\n确定小F同学12-04分享\"spring-cloud-02(springboot2)\"\n\n### 2019-11-13\n\n小F同学分享\"Spring-Cloud基础微服务快速搭建(springboot1)\"\n\n确定小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n### 2019-11-06\n\n小F同学分享\"JSP转HTML，EL表达式替换方式\"\n\n小J同学提出需求 \"Spring-cloud基础应用\"\n\n确定小秀同学11-20分享\"vue方式实现基础表格页面\"\n\n### 2019-10-30\n\n小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n确定11-13小F同学分享\"Spring-cloud基础应用\"\n\n### 2019-10-23\n\n确定11-6 由小F同学分享\"jsp和html相关知识\"\n\n小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n小X同学提出需求 \"想了解下jsp-->>html\"\n\n小L同学提出需求 \"想了解下NIO\"\n\n小秀同学提出需求 \"NodeJs\"\n\n小S同学提出需求 \"Dubbo\"\n\n### 2019-10-16\n\n讨论分享会执行方式\n\n确定10-23 由小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n确定10-30 由小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n### 2019-10-9\n\n确定每周三进行分享会\n\n## 缘由\n\n19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。\n\n## 目的\n\n创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。\n\n## 具体实施\n\n**时间**\n\n6:00 去吃饭\n\n6:30 - 7:00 开始分享会\n\n结束时间 <= 8:00\n\n**流程**\n\n讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问\n\n学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。\n\n奖励制度：//todo\n\n惩罚制度：//todo\n","source":"_posts/小组分享记录.md","raw":"---\ntitle: 小组分享记录(持续更新)\ndate: 2019-10-16 19:51:57\ncategories:\n- sendi趣味\ntags:\n- sendi\n---\n\n### 目录\n\n* [1.记录](#记录)\n* [2.缘由](#缘由)\n* [3.目的](#目的)\n* [4.具体实施](#具体实施)\n\n## 记录\n\n### Todo需求记录\n* jsp-->>html √\n* spring-cloud √ spring-cloud-02(springboot2) √\n* Vue √ Vue-02(组件化)\n* Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 \n* NIO √ NIO-02\n* NodeJs\n* Dubbo\n* Kafka\n\n### 2019-12-11\n\n小S同学12-11分享 \"Mysql锁机制\"\n\n小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”\n\n确定小秀同学2019-12-25分享“Vue-02组件化”\n\n### 2019-12-04\n\n小F同学12-04分享\"spring-cloud-02(springboot2) skywalking简单使用\"\n\n小H同学提出需求\"Kafka\"\n\n确认小H同学2019-12-18分享\"WebService服务调用\"\n\n### 2019-11-27\n\n小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n小F同学提出需求 \"NIO - 02\"\n\n确认小S同学12-11分享 \"Mysql锁机制\"\n\n### 2019-11-20\n\n小秀同学分享\"vue项目创建过程\"\n\n小F同学提出需求 \"Vue-02(组件化)\"\n\n小S同学提出需求 \"Mysql锁机制\"\n\n小广同学提出需求 \"spring-cloud-02(springboot2)\"\n\n确定小F同学12-04分享\"spring-cloud-02(springboot2)\"\n\n### 2019-11-13\n\n小F同学分享\"Spring-Cloud基础微服务快速搭建(springboot1)\"\n\n确定小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n### 2019-11-06\n\n小F同学分享\"JSP转HTML，EL表达式替换方式\"\n\n小J同学提出需求 \"Spring-cloud基础应用\"\n\n确定小秀同学11-20分享\"vue方式实现基础表格页面\"\n\n### 2019-10-30\n\n小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n确定11-13小F同学分享\"Spring-cloud基础应用\"\n\n### 2019-10-23\n\n确定11-6 由小F同学分享\"jsp和html相关知识\"\n\n小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n小X同学提出需求 \"想了解下jsp-->>html\"\n\n小L同学提出需求 \"想了解下NIO\"\n\n小秀同学提出需求 \"NodeJs\"\n\n小S同学提出需求 \"Dubbo\"\n\n### 2019-10-16\n\n讨论分享会执行方式\n\n确定10-23 由小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n确定10-30 由小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n### 2019-10-9\n\n确定每周三进行分享会\n\n## 缘由\n\n19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。\n\n## 目的\n\n创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。\n\n## 具体实施\n\n**时间**\n\n6:00 去吃饭\n\n6:30 - 7:00 开始分享会\n\n结束时间 <= 8:00\n\n**流程**\n\n讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问\n\n学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。\n\n奖励制度：//todo\n\n惩罚制度：//todo\n","slug":"小组分享记录","published":1,"updated":"2020-01-09T13:49:32.128Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7eg0011wkck7a04zl4p","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#记录\">1.记录</a></li>\n<li><a href=\"#缘由\">2.缘由</a></li>\n<li><a href=\"#目的\">3.目的</a></li>\n<li><a href=\"#具体实施\">4.具体实施</a></li>\n</ul>\n<h2 id=\"记录\"><a href=\"#记录\" class=\"headerlink\" title=\"记录\"></a>记录</h2><h3 id=\"Todo需求记录\"><a href=\"#Todo需求记录\" class=\"headerlink\" title=\"Todo需求记录\"></a>Todo需求记录</h3><ul>\n<li>jsp–&gt;&gt;html √</li>\n<li>spring-cloud √ spring-cloud-02(springboot2) √</li>\n<li>Vue √ Vue-02(组件化)</li>\n<li>Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 </li>\n<li>NIO √ NIO-02</li>\n<li>NodeJs</li>\n<li>Dubbo</li>\n<li>Kafka</li>\n</ul>\n<h3 id=\"2019-12-11\"><a href=\"#2019-12-11\" class=\"headerlink\" title=\"2019-12-11\"></a>2019-12-11</h3><p>小S同学12-11分享 “Mysql锁机制”</p>\n<p>小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”</p>\n<p>确定小秀同学2019-12-25分享“Vue-02组件化”</p>\n<h3 id=\"2019-12-04\"><a href=\"#2019-12-04\" class=\"headerlink\" title=\"2019-12-04\"></a>2019-12-04</h3><p>小F同学12-04分享”spring-cloud-02(springboot2) skywalking简单使用”</p>\n<p>小H同学提出需求”Kafka”</p>\n<p>确认小H同学2019-12-18分享”WebService服务调用”</p>\n<h3 id=\"2019-11-27\"><a href=\"#2019-11-27\" class=\"headerlink\" title=\"2019-11-27\"></a>2019-11-27</h3><p>小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<p>小F同学提出需求 “NIO - 02”</p>\n<p>确认小S同学12-11分享 “Mysql锁机制”</p>\n<h3 id=\"2019-11-20\"><a href=\"#2019-11-20\" class=\"headerlink\" title=\"2019-11-20\"></a>2019-11-20</h3><p>小秀同学分享”vue项目创建过程”</p>\n<p>小F同学提出需求 “Vue-02(组件化)”</p>\n<p>小S同学提出需求 “Mysql锁机制”</p>\n<p>小广同学提出需求 “spring-cloud-02(springboot2)”</p>\n<p>确定小F同学12-04分享”spring-cloud-02(springboot2)”</p>\n<h3 id=\"2019-11-13\"><a href=\"#2019-11-13\" class=\"headerlink\" title=\"2019-11-13\"></a>2019-11-13</h3><p>小F同学分享”Spring-Cloud基础微服务快速搭建(springboot1)”</p>\n<p>确定小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<h3 id=\"2019-11-06\"><a href=\"#2019-11-06\" class=\"headerlink\" title=\"2019-11-06\"></a>2019-11-06</h3><p>小F同学分享”JSP转HTML，EL表达式替换方式”</p>\n<p>小J同学提出需求 “Spring-cloud基础应用”</p>\n<p>确定小秀同学11-20分享”vue方式实现基础表格页面”</p>\n<h3 id=\"2019-10-30\"><a href=\"#2019-10-30\" class=\"headerlink\" title=\"2019-10-30\"></a>2019-10-30</h3><p>小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<p>确定11-13小F同学分享”Spring-cloud基础应用”</p>\n<h3 id=\"2019-10-23\"><a href=\"#2019-10-23\" class=\"headerlink\" title=\"2019-10-23\"></a>2019-10-23</h3><p>确定11-6 由小F同学分享”jsp和html相关知识”</p>\n<p>小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>小X同学提出需求 “想了解下jsp–&gt;&gt;html”</p>\n<p>小L同学提出需求 “想了解下NIO”</p>\n<p>小秀同学提出需求 “NodeJs”</p>\n<p>小S同学提出需求 “Dubbo”</p>\n<h3 id=\"2019-10-16\"><a href=\"#2019-10-16\" class=\"headerlink\" title=\"2019-10-16\"></a>2019-10-16</h3><p>讨论分享会执行方式</p>\n<p>确定10-23 由小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>确定10-30 由小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<h3 id=\"2019-10-9\"><a href=\"#2019-10-9\" class=\"headerlink\" title=\"2019-10-9\"></a>2019-10-9</h3><p>确定每周三进行分享会</p>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><p><strong>时间</strong></p>\n<p>6:00 去吃饭</p>\n<p>6:30 - 7:00 开始分享会</p>\n<p>结束时间 &lt;= 8:00</p>\n<p><strong>流程</strong></p>\n<p>讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问</p>\n<p>学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。</p>\n<p>奖励制度：//todo</p>\n<p>惩罚制度：//todo</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#记录\">1.记录</a></li>\n<li><a href=\"#缘由\">2.缘由</a></li>\n<li><a href=\"#目的\">3.目的</a></li>\n<li><a href=\"#具体实施\">4.具体实施</a></li>\n</ul>\n<h2 id=\"记录\"><a href=\"#记录\" class=\"headerlink\" title=\"记录\"></a>记录</h2><h3 id=\"Todo需求记录\"><a href=\"#Todo需求记录\" class=\"headerlink\" title=\"Todo需求记录\"></a>Todo需求记录</h3><ul>\n<li>jsp–&gt;&gt;html √</li>\n<li>spring-cloud √ spring-cloud-02(springboot2) √</li>\n<li>Vue √ Vue-02(组件化)</li>\n<li>Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 </li>\n<li>NIO √ NIO-02</li>\n<li>NodeJs</li>\n<li>Dubbo</li>\n<li>Kafka</li>\n</ul>\n<h3 id=\"2019-12-11\"><a href=\"#2019-12-11\" class=\"headerlink\" title=\"2019-12-11\"></a>2019-12-11</h3><p>小S同学12-11分享 “Mysql锁机制”</p>\n<p>小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”</p>\n<p>确定小秀同学2019-12-25分享“Vue-02组件化”</p>\n<h3 id=\"2019-12-04\"><a href=\"#2019-12-04\" class=\"headerlink\" title=\"2019-12-04\"></a>2019-12-04</h3><p>小F同学12-04分享”spring-cloud-02(springboot2) skywalking简单使用”</p>\n<p>小H同学提出需求”Kafka”</p>\n<p>确认小H同学2019-12-18分享”WebService服务调用”</p>\n<h3 id=\"2019-11-27\"><a href=\"#2019-11-27\" class=\"headerlink\" title=\"2019-11-27\"></a>2019-11-27</h3><p>小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<p>小F同学提出需求 “NIO - 02”</p>\n<p>确认小S同学12-11分享 “Mysql锁机制”</p>\n<h3 id=\"2019-11-20\"><a href=\"#2019-11-20\" class=\"headerlink\" title=\"2019-11-20\"></a>2019-11-20</h3><p>小秀同学分享”vue项目创建过程”</p>\n<p>小F同学提出需求 “Vue-02(组件化)”</p>\n<p>小S同学提出需求 “Mysql锁机制”</p>\n<p>小广同学提出需求 “spring-cloud-02(springboot2)”</p>\n<p>确定小F同学12-04分享”spring-cloud-02(springboot2)”</p>\n<h3 id=\"2019-11-13\"><a href=\"#2019-11-13\" class=\"headerlink\" title=\"2019-11-13\"></a>2019-11-13</h3><p>小F同学分享”Spring-Cloud基础微服务快速搭建(springboot1)”</p>\n<p>确定小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<h3 id=\"2019-11-06\"><a href=\"#2019-11-06\" class=\"headerlink\" title=\"2019-11-06\"></a>2019-11-06</h3><p>小F同学分享”JSP转HTML，EL表达式替换方式”</p>\n<p>小J同学提出需求 “Spring-cloud基础应用”</p>\n<p>确定小秀同学11-20分享”vue方式实现基础表格页面”</p>\n<h3 id=\"2019-10-30\"><a href=\"#2019-10-30\" class=\"headerlink\" title=\"2019-10-30\"></a>2019-10-30</h3><p>小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<p>确定11-13小F同学分享”Spring-cloud基础应用”</p>\n<h3 id=\"2019-10-23\"><a href=\"#2019-10-23\" class=\"headerlink\" title=\"2019-10-23\"></a>2019-10-23</h3><p>确定11-6 由小F同学分享”jsp和html相关知识”</p>\n<p>小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>小X同学提出需求 “想了解下jsp–&gt;&gt;html”</p>\n<p>小L同学提出需求 “想了解下NIO”</p>\n<p>小秀同学提出需求 “NodeJs”</p>\n<p>小S同学提出需求 “Dubbo”</p>\n<h3 id=\"2019-10-16\"><a href=\"#2019-10-16\" class=\"headerlink\" title=\"2019-10-16\"></a>2019-10-16</h3><p>讨论分享会执行方式</p>\n<p>确定10-23 由小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>确定10-30 由小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<h3 id=\"2019-10-9\"><a href=\"#2019-10-9\" class=\"headerlink\" title=\"2019-10-9\"></a>2019-10-9</h3><p>确定每周三进行分享会</p>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><p><strong>时间</strong></p>\n<p>6:00 去吃饭</p>\n<p>6:30 - 7:00 开始分享会</p>\n<p>结束时间 &lt;= 8:00</p>\n<p><strong>流程</strong></p>\n<p>讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问</p>\n<p>学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。</p>\n<p>奖励制度：//todo</p>\n<p>惩罚制度：//todo</p>\n"},{"title":"搭建自己的linux工作环境","date":"2019-09-30T10:07:02.000Z","_content":"\n## 缘由\n由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！\n痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。\n\n\n\nintel wifi linux驱动包\nhttps://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\n\n升级内核\n1.自行下载内核，然后采用yum localinstall进行安装\n4.15内核\nhttp://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\n\n2.联网后配置yum源进行安装\n导入key\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n安装yum源\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\n查看系统可以使用的内核\nsudo awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg\n\n\n删除不必要的内核\nyum remove kernel-3.10.0-327.el7.x86_64\n\n\noffice常用办公软件\nyum install libreoffice\n\ncentos7.1没有wifi-GUI GUI联网得用wap_suplication\n\n切换到centos7.6\n\n安装vmware player\n\n\n\n.......未完待续","source":"_posts/搭建自己的linux工作环境.md","raw":"---\ntitle: 搭建自己的linux工作环境\ndate: 2019-09-30 18:07:02\ncategories:\n- 工具\ntags:\n- linux\n- 工作环境\n\n---\n\n## 缘由\n由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！\n痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。\n\n\n\nintel wifi linux驱动包\nhttps://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\n\n升级内核\n1.自行下载内核，然后采用yum localinstall进行安装\n4.15内核\nhttp://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\n\n2.联网后配置yum源进行安装\n导入key\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n安装yum源\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\n查看系统可以使用的内核\nsudo awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg\n\n\n删除不必要的内核\nyum remove kernel-3.10.0-327.el7.x86_64\n\n\noffice常用办公软件\nyum install libreoffice\n\ncentos7.1没有wifi-GUI GUI联网得用wap_suplication\n\n切换到centos7.6\n\n安装vmware player\n\n\n\n.......未完待续","slug":"搭建自己的linux工作环境","published":1,"updated":"2020-01-09T13:49:32.131Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck56vk7fg001rwkckm6uls35r","content":"<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！<br>痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。</p>\n<p>intel wifi linux驱动包<br><a href=\"https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\" target=\"_blank\" rel=\"noopener\">https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html</a></p>\n<p>升级内核<br>1.自行下载内核，然后采用yum localinstall进行安装<br>4.15内核<br><a href=\"http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\" target=\"_blank\" rel=\"noopener\">http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm</a></p>\n<p>2.联网后配置yum源进行安装<br>导入key<br>rpm –import <a href=\"https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\" target=\"_blank\" rel=\"noopener\">https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</a><br>安装yum源<br>rpm -Uvh <a href=\"http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\" target=\"_blank\" rel=\"noopener\">http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</a><br>查看系统可以使用的内核<br>sudo awk -F&#39; ‘$1==”menuentry “ {print i++ “ : “ $2}’ /etc/grub2.cfg</p>\n<p>删除不必要的内核<br>yum remove kernel-3.10.0-327.el7.x86_64</p>\n<p>office常用办公软件<br>yum install libreoffice</p>\n<p>centos7.1没有wifi-GUI GUI联网得用wap_suplication</p>\n<p>切换到centos7.6</p>\n<p>安装vmware player</p>\n<p>…….未完待续</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！<br>痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。</p>\n<p>intel wifi linux驱动包<br><a href=\"https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\" target=\"_blank\" rel=\"noopener\">https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html</a></p>\n<p>升级内核<br>1.自行下载内核，然后采用yum localinstall进行安装<br>4.15内核<br><a href=\"http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\" target=\"_blank\" rel=\"noopener\">http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm</a></p>\n<p>2.联网后配置yum源进行安装<br>导入key<br>rpm –import <a href=\"https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\" target=\"_blank\" rel=\"noopener\">https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</a><br>安装yum源<br>rpm -Uvh <a href=\"http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\" target=\"_blank\" rel=\"noopener\">http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</a><br>查看系统可以使用的内核<br>sudo awk -F&#39; ‘$1==”menuentry “ {print i++ “ : “ $2}’ /etc/grub2.cfg</p>\n<p>删除不必要的内核<br>yum remove kernel-3.10.0-327.el7.x86_64</p>\n<p>office常用办公软件<br>yum install libreoffice</p>\n<p>centos7.1没有wifi-GUI GUI联网得用wap_suplication</p>\n<p>切换到centos7.6</p>\n<p>安装vmware player</p>\n<p>…….未完待续</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ck56vk7ck0000wkcktsv10nz3","category_id":"ck56vk7cv0002wkckk61g1q31","_id":"ck56vk7da0009wkck8fzvfnvv"},{"post_id":"ck56vk7cr0001wkckvdyt7z59","category_id":"ck56vk7d40006wkckhuuax6hx","_id":"ck56vk7dh000dwkckhwa73zwt"},{"post_id":"ck56vk7d00004wkcklhoktrn7","category_id":"ck56vk7d40006wkckhuuax6hx","_id":"ck56vk7dj000fwkck5931xj5y"},{"post_id":"ck56vk7d20005wkck6s1uc7ui","category_id":"ck56vk7d40006wkckhuuax6hx","_id":"ck56vk7dn000iwkck2xvb381g"},{"post_id":"ck56vk7e9000xwkckew11cez0","category_id":"ck56vk7cv0002wkckk61g1q31","_id":"ck56vk7ej0012wkckim3rr4so"},{"post_id":"ck56vk7e7000wwkckfe7gb5uf","category_id":"ck56vk7eb000ywkcklzjldkn2","_id":"ck56vk7en0015wkckzyreimmt"},{"post_id":"ck56vk7ee0010wkckbmcc0g8o","category_id":"ck56vk7ek0013wkcku19yaqja","_id":"ck56vk7er0018wkcky2h956yd"},{"post_id":"ck56vk7eg0011wkck7a04zl4p","category_id":"ck56vk7eo0016wkck9ad43xvb","_id":"ck56vk7et001awkckh9x0ixsx"},{"post_id":"ck56vk7fg001rwkckm6uls35r","category_id":"ck56vk7eb000ywkcklzjldkn2","_id":"ck56vk7fq001uwkckhgpu9qhs"}],"PostTag":[{"post_id":"ck56vk7ck0000wkcktsv10nz3","tag_id":"ck56vk7cy0003wkckkotyrfzy","_id":"ck56vk7d80008wkck83abqcj3"},{"post_id":"ck56vk7cr0001wkckvdyt7z59","tag_id":"ck56vk7d60007wkck9btia70c","_id":"ck56vk7dm000hwkckfzufss4j"},{"post_id":"ck56vk7cr0001wkckvdyt7z59","tag_id":"ck56vk7dc000bwkckjjpsg44s","_id":"ck56vk7do000jwkck5efp40is"},{"post_id":"ck56vk7cr0001wkckvdyt7z59","tag_id":"ck56vk7di000ewkckpce3rq7k","_id":"ck56vk7dr000lwkckomccmc1a"},{"post_id":"ck56vk7d00004wkcklhoktrn7","tag_id":"ck56vk7d60007wkck9btia70c","_id":"ck56vk7dv000owkckdb6kj2nw"},{"post_id":"ck56vk7d00004wkcklhoktrn7","tag_id":"ck56vk7dc000bwkckjjpsg44s","_id":"ck56vk7dx000pwkckc6a0g2vc"},{"post_id":"ck56vk7d00004wkcklhoktrn7","tag_id":"ck56vk7di000ewkckpce3rq7k","_id":"ck56vk7dz000rwkckrdtytwmy"},{"post_id":"ck56vk7d20005wkck6s1uc7ui","tag_id":"ck56vk7du000nwkckeff3sklt","_id":"ck56vk7e2000twkckcyfbo6yl"},{"post_id":"ck56vk7d20005wkck6s1uc7ui","tag_id":"ck56vk7dy000qwkcky780yfgi","_id":"ck56vk7e3000uwkckqon65vvk"},{"post_id":"ck56vk7d20005wkck6s1uc7ui","tag_id":"ck56vk7e0000swkck9ar1yg6x","_id":"ck56vk7e4000vwkck1fa7zrcc"},{"post_id":"ck56vk7e7000wwkckfe7gb5uf","tag_id":"ck56vk7ed000zwkckpebh30zo","_id":"ck56vk7ey001dwkck4g4u4yt2"},{"post_id":"ck56vk7e7000wwkckfe7gb5uf","tag_id":"ck56vk7el0014wkckt4qrxunp","_id":"ck56vk7ez001ewkckft3oubdx"},{"post_id":"ck56vk7e7000wwkckfe7gb5uf","tag_id":"ck56vk7ep0017wkcksht3fzy5","_id":"ck56vk7f2001gwkck95g00w62"},{"post_id":"ck56vk7e7000wwkckfe7gb5uf","tag_id":"ck56vk7es0019wkck9k9b6an2","_id":"ck56vk7f3001hwkckczu4h4l3"},{"post_id":"ck56vk7e7000wwkckfe7gb5uf","tag_id":"ck56vk7ev001bwkck572rirtq","_id":"ck56vk7f6001jwkckxqzxzbgr"},{"post_id":"ck56vk7e9000xwkckew11cez0","tag_id":"ck56vk7ew001cwkck9k3frhde","_id":"ck56vk7f7001kwkckipx002hd"},{"post_id":"ck56vk7e9000xwkckew11cez0","tag_id":"ck56vk7f1001fwkckezl2m4j8","_id":"ck56vk7fa001mwkckraz66mb8"},{"post_id":"ck56vk7ee0010wkckbmcc0g8o","tag_id":"ck56vk7f5001iwkckvjz3nbjx","_id":"ck56vk7fc001owkckhqltoohb"},{"post_id":"ck56vk7ee0010wkckbmcc0g8o","tag_id":"ck56vk7f8001lwkckfc41v2ut","_id":"ck56vk7fd001pwkcky6t6yqok"},{"post_id":"ck56vk7eg0011wkck7a04zl4p","tag_id":"ck56vk7fb001nwkckdmheuibn","_id":"ck56vk7fe001qwkckptyp3by4"},{"post_id":"ck56vk7fg001rwkckm6uls35r","tag_id":"ck56vk7fo001twkckuv154ed4","_id":"ck56vk7ft001wwkckxoco03zk"},{"post_id":"ck56vk7fg001rwkckm6uls35r","tag_id":"ck56vk7fr001vwkckimz5i8a7","_id":"ck56vk7fu001xwkck1vycqojd"}],"Tag":[{"name":"配置","_id":"ck56vk7cy0003wkckkotyrfzy"},{"name":"spring-cloud","_id":"ck56vk7d60007wkck9btia70c"},{"name":"微服务","_id":"ck56vk7dc000bwkckjjpsg44s"},{"name":"框架搭建","_id":"ck56vk7di000ewkckpce3rq7k"},{"name":"CompletableFuture","_id":"ck56vk7du000nwkckeff3sklt"},{"name":"jdk8","_id":"ck56vk7dy000qwkcky780yfgi"},{"name":"并发编程","_id":"ck56vk7e0000swkck9ar1yg6x"},{"name":"Linux","_id":"ck56vk7ed000zwkckpebh30zo"},{"name":"Tar","_id":"ck56vk7el0014wkckt4qrxunp"},{"name":"压缩解压缩","_id":"ck56vk7ep0017wkcksht3fzy5"},{"name":"加密解密","_id":"ck56vk7es0019wkck9k9b6an2"},{"name":"大文本","_id":"ck56vk7ev001bwkck572rirtq"},{"name":"Mysql","_id":"ck56vk7ew001cwkck9k3frhde"},{"name":"死锁","_id":"ck56vk7f1001fwkckezl2m4j8"},{"name":"JSP","_id":"ck56vk7f5001iwkckvjz3nbjx"},{"name":"EL表达式","_id":"ck56vk7f8001lwkckfc41v2ut"},{"name":"sendi","_id":"ck56vk7fb001nwkckdmheuibn"},{"name":"linux","_id":"ck56vk7fo001twkckuv154ed4"},{"name":"工作环境","_id":"ck56vk7fr001vwkckimz5i8a7"}]}}